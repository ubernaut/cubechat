(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.MultiformatsMultiaddrMatcher = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var MultiformatsMultiaddrMatcher=(()=>{var L=Object.defineProperty;var ye=Object.getOwnPropertyDescriptor;var Ae=Object.getOwnPropertyNames;var ge=Object.prototype.hasOwnProperty;var Ie=(t,e)=>{for(var r in e)L(t,r,{get:e[r],enumerable:!0})},ve=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of Ae(e))!ge.call(t,i)&&i!==r&&L(t,i,{get:()=>e[i],enumerable:!(n=ye(e,i))||n.enumerable});return t};var Pe=t=>ve(L({},"__esModule",{value:!0}),t);var ht={};Ie(ht,{Circuit:()=>tt,DNS:()=>Oe,DNS4:()=>ke,DNS6:()=>ze,DNSADDR:()=>Ve,HTTP:()=>ot,HTTPS:()=>at,IP:()=>Qe,IP4:()=>Ge,IP6:()=>$e,IP_OR_DOMAIN:()=>Be,Memory:()=>ft,P2P:()=>Ye,PEER_ID:()=>Me,QUIC:()=>He,QUICV1:()=>je,TCP:()=>Xe,UDP:()=>Le,Unix:()=>ut,WebRTC:()=>nt,WebRTCDirect:()=>Ze,WebSockets:()=>Fe,WebSocketsSecure:()=>Je,WebTransport:()=>Ke});var V=class{index=0;input="";new(e){return this.index=0,this.input=e,this}readAtomically(e){let r=this.index,n=e();return n===void 0&&(this.index=r),n}parseWith(e){let r=e();if(this.index===this.input.length)return r}peekChar(){if(!(this.index>=this.input.length))return this.input[this.index]}readChar(){if(!(this.index>=this.input.length))return this.input[this.index++]}readGivenChar(e){return this.readAtomically(()=>{let r=this.readChar();if(r===e)return r})}readSeparator(e,r,n){return this.readAtomically(()=>{if(!(r>0&&this.readGivenChar(e)===void 0))return n()})}readNumber(e,r,n,i){return this.readAtomically(()=>{let o=0,f=0,p=this.peekChar();if(p===void 0)return;let y=p==="0",S=2**(8*i)-1;for(;;){let C=this.readAtomically(()=>{let k=this.readChar();if(k===void 0)return;let T=Number.parseInt(k,e);if(!Number.isNaN(T))return T});if(C===void 0)break;if(o*=e,o+=C,o>S||(f+=1,r!==void 0&&f>r))return}if(f!==0)return!n&&y&&f>1?void 0:o})}readIPv4Addr(){return this.readAtomically(()=>{let e=new Uint8Array(4);for(let r=0;r<e.length;r++){let n=this.readSeparator(".",r,()=>this.readNumber(10,3,!1,1));if(n===void 0)return;e[r]=n}return e})}readIPv6Addr(){let e=r=>{for(let n=0;n<r.length/2;n++){let i=n*2;if(n<r.length-3){let f=this.readSeparator(":",n,()=>this.readIPv4Addr());if(f!==void 0)return r[i]=f[0],r[i+1]=f[1],r[i+2]=f[2],r[i+3]=f[3],[i+4,!0]}let o=this.readSeparator(":",n,()=>this.readNumber(16,4,!0,2));if(o===void 0)return[i,!1];r[i]=o>>8,r[i+1]=o&255}return[r.length,!1]};return this.readAtomically(()=>{let r=new Uint8Array(16),[n,i]=e(r);if(n===16)return r;if(i||this.readGivenChar(":")===void 0||this.readGivenChar(":")===void 0)return;let o=new Uint8Array(14),f=16-(n+2),[p]=e(o.subarray(0,f));return r.set(o.subarray(0,p),16-p),r})}readIPAddr(){return this.readIPv4Addr()??this.readIPv6Addr()}};var Ue=45,_e=15,O=new V;function re(t){if(!(t.length>_e))return O.new(t).parseWith(()=>O.readIPv4Addr())}function ne(t){if(t.includes("%")&&(t=t.split("%")[0]),!(t.length>Ue))return O.new(t).parseWith(()=>O.readIPv6Addr())}function ie(t){return!!re(t)}function oe(t){return!!ne(t)}var At=new Uint8Array(0);function se(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function Se(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),f=o.charCodeAt(0);if(r[f]!==255)throw new TypeError(o+" is ambiguous");r[f]=i}var p=t.length,y=t.charAt(0),S=Math.log(p)/Math.log(256),C=Math.log(256)/Math.log(p);function k(u){if(u instanceof Uint8Array||(ArrayBuffer.isView(u)?u=new Uint8Array(u.buffer,u.byteOffset,u.byteLength):Array.isArray(u)&&(u=Uint8Array.from(u))),!(u instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(u.length===0)return"";for(var x=0,E=0,b=0,A=u.length;b!==A&&u[b]===0;)b++,x++;for(var g=(A-b)*C+1>>>0,m=new Uint8Array(g);b!==A;){for(var I=u[b],U=0,w=g-1;(I!==0||U<E)&&w!==-1;w--,U++)I+=256*m[w]>>>0,m[w]=I%p>>>0,I=I/p>>>0;if(I!==0)throw new Error("Non-zero carry");E=U,b++}for(var v=g-E;v!==g&&m[v]===0;)v++;for(var z=y.repeat(x);v<g;++v)z+=t.charAt(m[v]);return z}function T(u){if(typeof u!="string")throw new TypeError("Expected String");if(u.length===0)return new Uint8Array;var x=0;if(u[x]!==" "){for(var E=0,b=0;u[x]===y;)E++,x++;for(var A=(u.length-x)*S+1>>>0,g=new Uint8Array(A);u[x];){var m=r[u.charCodeAt(x)];if(m===255)return;for(var I=0,U=A-1;(m!==0||I<b)&&U!==-1;U--,I++)m+=p*g[U]>>>0,g[U]=m%256>>>0,m=m/256>>>0;if(m!==0)throw new Error("Non-zero carry");b=I,x++}if(u[x]!==" "){for(var w=A-b;w!==A&&g[w]===0;)w++;for(var v=new Uint8Array(E+(A-w)),z=E;w!==A;)v[z++]=g[w++];return v}}}function we(u){var x=T(u);if(x)return x;throw new Error(`Non-${e} character`)}return{encode:k,decodeUnsafe:T,decode:we}}var Ce=Se,Ee=Ce,ae=Ee;var q=class{name;prefix;baseEncode;constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},H=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,r,n){this.name=e,this.prefix=r;let i=r.codePointAt(0);if(i===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=i,this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return ce(this,e)}},j=class{decoders;constructor(e){this.decoders=e}or(e){return ce(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function ce(t,e){return new j({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}var F=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new q(e,r,n),this.decoder=new H(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function fe({name:t,prefix:e,encode:r,decode:n}){return new F(t,e,r,n)}function J({name:t,prefix:e,alphabet:r}){let{encode:n,decode:i}=ae(r,t);return fe({prefix:e,name:t,encode:n,decode:o=>se(i(o))})}function Ne(t,e,r,n){let i=t.length;for(;t[i-1]==="=";)--i;let o=new Uint8Array(i*r/8|0),f=0,p=0,y=0;for(let S=0;S<i;++S){let C=e[t[S]];if(C===void 0)throw new SyntaxError(`Non-${n} character`);p=p<<r|C,f+=r,f>=8&&(f-=8,o[y++]=255&p>>f)}if(f>=r||(255&p<<8-f)!==0)throw new SyntaxError("Unexpected end of data");return o}function De(t,e,r){let n=e[e.length-1]==="=",i=(1<<r)-1,o="",f=0,p=0;for(let y=0;y<t.length;++y)for(p=p<<8|t[y],f+=8;f>r;)f-=r,o+=e[i&p>>f];if(f!==0&&(o+=e[i&p<<r-f]),n)for(;(o.length*r&7)!==0;)o+="=";return o}function Te(t){let e={};for(let r=0;r<t.length;++r)e[t[r]]=r;return e}function W({name:t,prefix:e,bitsPerChar:r,alphabet:n}){let i=Te(n);return fe({prefix:e,name:t,encode(o){return De(o,n,r)},decode(o){return Ne(o,i,r,t)}})}var de=J({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),St=J({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Nt=W({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Dt=W({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),ue=W({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Tt=W({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var We=t=>t.toString().split("/").slice(1),N=t=>({match:e=>e.length<1?!1:t(e[0])?e.slice(1):!1,pattern:"fn"}),s=t=>({match:e=>N(r=>r===t).match(e),pattern:t}),_=()=>({match:t=>N(e=>typeof e=="string").match(t),pattern:"{string}"}),D=()=>({match:t=>N(e=>!isNaN(parseInt(e))).match(t),pattern:"{number}"}),d=()=>({match:t=>{if(t.length<2||t[0]!=="p2p"&&t[0]!=="ipfs")return!1;if(t[1].startsWith("Q")||t[1].startsWith("1"))try{de.decode(`z${t[1]}`)}catch{return!1}else return!1;return t.slice(2)},pattern:"/p2p/{peerid}"}),R=()=>({match:t=>{if(t.length<2||t[0]!=="certhash")return!1;try{ue.decode(t[1])}catch{return!1}return t.slice(2)},pattern:"/certhash/{certhash}"}),c=t=>({match:e=>{let r=t.match(e);return r===!1?e:r},pattern:`optional(${t.pattern})`}),l=(...t)=>({match:e=>{let r;for(let n of t){let i=n.match(e);i!==!1&&(r==null||i.length<r.length)&&(r=i)}return r??!1},pattern:`or(${t.map(e=>e.pattern).join(", ")})`}),a=(...t)=>({match:e=>{for(let r of t){let n=r.match(e);if(n===!1)return!1;e=n}return e},pattern:`and(${t.map(e=>e.pattern).join(", ")})`});function h(...t){function e(i){let o=We(i);for(let f of t){let p=f.match(o);if(p===!1)return!1;o=p}return o}function r(i){return e(i)!==!1}function n(i){let o=e(i);return o===!1?!1:o.length===0}return{matchers:t,matches:r,exactMatch:n}}var Re=d(),Me=h(Re),G=a(s("dns4"),_()),$=a(s("dns6"),_()),Q=a(s("dnsaddr"),_()),K=a(s("dns"),_()),ke=h(G,c(d())),ze=h($,c(d())),Ve=h(Q,c(d())),Oe=h(l(K,Q,G,$),c(d())),he=a(s("ip4"),N(ie)),pe=a(s("ip6"),N(oe)),Y=l(he,pe),P=l(Y,K,G,$,Q),Be=h(l(Y,a(l(K,Q,G,$),c(d())))),Ge=h(he),$e=h(pe),Qe=h(Y),ee=a(P,s("tcp"),D()),M=a(P,s("udp"),D()),Xe=h(a(ee,c(d()))),Le=h(M),te=a(M,s("quic"),c(d())),X=a(M,s("quic-v1"),c(d())),qe=l(te,X),He=h(te),je=h(X),Z=l(P,ee,M,te,X),le=l(a(Z,s("ws"),c(d()))),Fe=h(le),xe=l(a(Z,s("wss"),c(d())),a(Z,s("tls"),c(a(s("sni"),_())),s("ws"),c(d()))),Je=h(xe),me=a(M,s("webrtc-direct"),c(R()),c(R()),c(d())),Ze=h(me),be=a(X,s("webtransport"),c(R()),c(R()),c(d())),Ke=h(be),B=l(le,xe,a(ee,c(d())),a(qe,c(d())),a(P,c(d())),me,be,d()),Ye=h(B),et=a(B,s("p2p-circuit"),d()),tt=h(et),rt=l(a(B,s("p2p-circuit"),s("webrtc"),c(d())),a(B,s("webrtc"),c(d())),a(s("webrtc"),c(d()))),nt=h(rt),it=l(a(P,s("tcp"),D(),s("http"),c(d())),a(P,s("http"),c(d()))),ot=h(it),st=l(a(P,s("tcp"),l(a(s("443"),s("http")),a(D(),s("https")),a(D(),s("tls"),s("http"))),c(d())),a(P,s("tls"),s("http"),c(d())),a(P,s("https"),c(d()))),at=h(st),ct=l(a(s("memory"),_(),c(d()))),ft=h(ct),dt=l(a(s("unix"),_(),c(d()))),ut=h(dt);return Pe(ht);})();
return MultiformatsMultiaddrMatcher}));
//# sourceMappingURL=index.min.js.map
