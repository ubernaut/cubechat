(function (root, factory) {(typeof module === 'object' && module.exports) ? module.exports = factory() : root.Libp2PPeerId = factory()}(typeof self !== 'undefined' ? self : this, function () {
"use strict";var Libp2PPeerId=(()=>{var br=Object.defineProperty;var Ps=Object.getOwnPropertyDescriptor;var Ms=Object.getOwnPropertyNames;var Hs=Object.prototype.hasOwnProperty;var st=(e,t)=>{for(var r in t)br(e,r,{get:t[r],enumerable:!0})},qs=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of Ms(t))!Hs.call(e,o)&&o!==r&&br(e,o,{get:()=>t[o],enumerable:!(n=Ps(t,o))||n.enumerable});return e};var Vs=e=>qs(br({},"__esModule",{value:!0}),e);var la={};st(la,{peerIdFromCID:()=>ks,peerIdFromMultihash:()=>kn,peerIdFromPrivateKey:()=>fa,peerIdFromPublicKey:()=>Os,peerIdFromString:()=>aa});var bt=class extends Error{static name="InvalidParametersError";constructor(t="Invalid parameters"){super(t),this.name="InvalidParametersError"}},He=class extends Error{static name="InvalidPublicKeyError";constructor(t="Invalid public key"){super(t),this.name="InvalidPublicKeyError"}};var qe=class extends Error{static name="InvalidCIDError";constructor(t="Invalid CID"){super(t),this.name="InvalidCIDError"}},Ve=class extends Error{static name="InvalidMultihashError";constructor(t="Invalid Multihash"){super(t),this.name="InvalidMultihashError"}};var zt=class extends Error{static name="UnsupportedKeyTypeError";constructor(t="Unsupported key type"){super(t),this.name="UnsupportedKeyTypeError"}};var yr=Symbol.for("@libp2p/peer-id");var Sr={};st(Sr,{base58btc:()=>Y,base58flickr:()=>Xs});var ba=new Uint8Array(0);function Hn(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function gt(e){if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")}function qn(e){return new TextEncoder().encode(e)}function Vn(e){return new TextDecoder().decode(e)}function Zs(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<e.length;o++){var s=e.charAt(o),i=s.charCodeAt(0);if(r[i]!==255)throw new TypeError(s+" is ambiguous");r[i]=o}var a=e.length,c=e.charAt(0),f=Math.log(a)/Math.log(256),m=Math.log(256)/Math.log(a);function u(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var v=0,A=0,b=0,B=p.length;b!==B&&p[b]===0;)b++,v++;for(var y=(B-b)*m+1>>>0,I=new Uint8Array(y);b!==B;){for(var C=p[b],k=0,P=y-1;(C!==0||k<A)&&P!==-1;P--,k++)C+=256*I[P]>>>0,I[P]=C%a>>>0,C=C/a>>>0;if(C!==0)throw new Error("Non-zero carry");A=k,b++}for(var g=y-A;g!==y&&I[g]===0;)g++;for(var x=c.repeat(v);g<y;++g)x+=e.charAt(I[g]);return x}function w(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var v=0;if(p[v]!==" "){for(var A=0,b=0;p[v]===c;)A++,v++;for(var B=(p.length-v)*f+1>>>0,y=new Uint8Array(B);p[v];){var I=r[p.charCodeAt(v)];if(I===255)return;for(var C=0,k=B-1;(I!==0||C<b)&&k!==-1;k--,C++)I+=a*y[k]>>>0,y[k]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");b=C,v++}if(p[v]!==" "){for(var P=B-b;P!==B&&y[P]===0;)P++;for(var g=new Uint8Array(A+(B-P)),x=A;P!==B;)g[x++]=y[P++];return g}}}function S(p){var v=w(p);if(v)return v;throw new Error(`Non-${t} character`)}return{encode:u,decodeUnsafe:w,decode:S}}var Fs=Zs,js=Fs,Fn=js;var xr=class{name;prefix;baseEncode;constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}},gr=class{name;prefix;baseDecode;prefixCodePoint;constructor(t,r,n){this.name=t,this.prefix=r;let o=r.codePointAt(0);if(o===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=o,this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return jn(this,t)}},wr=class{decoders;constructor(t){this.decoders=t}or(t){return jn(this,t)}decode(t){let r=t[0],n=this.decoders[r];if(n!=null)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function jn(e,t){return new wr({...e.decoders??{[e.prefix]:e},...t.decoders??{[t.prefix]:t}})}var Er=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new xr(t,r,n),this.decoder=new gr(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}};function Yt({name:e,prefix:t,encode:r,decode:n}){return new Er(e,t,r,n)}function _t({name:e,prefix:t,alphabet:r}){let{encode:n,decode:o}=Fn(r,e);return Yt({prefix:t,name:e,encode:n,decode:s=>gt(o(s))})}function Gs(e,t,r,n){let o=e.length;for(;e[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),i=0,a=0,c=0;for(let f=0;f<o;++f){let m=t[e[f]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);a=a<<r|m,i+=r,i>=8&&(i-=8,s[c++]=255&a>>i)}if(i>=r||(255&a<<8-i)!==0)throw new SyntaxError("Unexpected end of data");return s}function zs(e,t,r){let n=t[t.length-1]==="=",o=(1<<r)-1,s="",i=0,a=0;for(let c=0;c<e.length;++c)for(a=a<<8|e[c],i+=8;i>r;)i-=r,s+=t[o&a>>i];if(i!==0&&(s+=t[o&a<<r-i]),n)for(;(s.length*r&7)!==0;)s+="=";return s}function Ys(e){let t={};for(let r=0;r<e.length;++r)t[e[r]]=r;return t}function G({name:e,prefix:t,bitsPerChar:r,alphabet:n}){let o=Ys(n);return Yt({prefix:t,name:e,encode(s){return zs(s,n,r)},decode(s){return Gs(s,o,r,e)}})}var Y=_t({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Xs=_t({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Ar={};st(Ar,{base32:()=>Xt,base32hex:()=>Qs,base32hexpad:()=>ei,base32hexpadupper:()=>ri,base32hexupper:()=>ti,base32pad:()=>Ws,base32padupper:()=>Js,base32upper:()=>$s,base32z:()=>ni});var Xt=G({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),$s=G({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ws=G({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Js=G({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Qs=G({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),ti=G({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),ei=G({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),ri=G({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),ni=G({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Br={};st(Br,{base36:()=>de,base36upper:()=>oi});var de=_t({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),oi=_t({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var si=Yn,Gn=128,ii=127,ci=~ii,ai=Math.pow(2,31);function Yn(e,t,r){t=t||[],r=r||0;for(var n=r;e>=ai;)t[r++]=e&255|Gn,e/=128;for(;e&ci;)t[r++]=e&255|Gn,e>>>=7;return t[r]=e|0,Yn.bytes=r-n+1,t}var fi=vr,ui=128,zn=127;function vr(e,n){var r=0,n=n||0,o=0,s=n,i,a=e.length;do{if(s>=a)throw vr.bytes=0,new RangeError("Could not decode varint");i=e[s++],r+=o<28?(i&zn)<<o:(i&zn)*Math.pow(2,o),o+=7}while(i>=ui);return vr.bytes=s-n,r}var hi=Math.pow(2,7),li=Math.pow(2,14),di=Math.pow(2,21),pi=Math.pow(2,28),mi=Math.pow(2,35),bi=Math.pow(2,42),yi=Math.pow(2,49),xi=Math.pow(2,56),gi=Math.pow(2,63),wi=function(e){return e<hi?1:e<li?2:e<di?3:e<pi?4:e<mi?5:e<bi?6:e<yi?7:e<xi?8:e<gi?9:10},Ei={encode:si,decode:fi,encodingLength:wi},Si=Ei,pe=Si;function me(e,t=0){return[pe.decode(e,t),pe.decode.bytes]}function $t(e,t,r=0){return pe.encode(e,t,r),t}function Wt(e){return pe.encodingLength(e)}function Qt(e,t){let r=t.byteLength,n=Wt(e),o=n+Wt(r),s=new Uint8Array(o+r);return $t(e,s,0),$t(r,s,n),s.set(t,o),new Jt(e,r,t,s)}function be(e){let t=gt(e),[r,n]=me(t),[o,s]=me(t.subarray(n)),i=t.subarray(n+s);if(i.byteLength!==o)throw new Error("Incorrect length");return new Jt(r,o,i,t)}function Xn(e,t){if(e===t)return!0;{let r=t;return e.code===r.code&&e.size===r.size&&r.bytes instanceof Uint8Array&&Hn(e.bytes,r.bytes)}}var Jt=class{code;size;digest;bytes;constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}};function $n(e,t){let{bytes:r,version:n}=e;switch(n){case 0:return Bi(r,Ir(e),t??Y.encoder);default:return vi(r,Ir(e),t??Xt.encoder)}}var Wn=new WeakMap;function Ir(e){let t=Wn.get(e);if(t==null){let r=new Map;return Wn.set(e,r),r}return t}var et=class e{code;version;multihash;bytes;"/";constructor(t,r,n,o){this.code=r,this.version=t,this.multihash=n,this.bytes=o,this["/"]=o}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:t,multihash:r}=this;if(t!==ye)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==Ii)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return e.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:t,digest:r}=this.multihash,n=Qt(t,r);return e.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(t){return e.equals(this,t)}static equals(t,r){let n=r;return n!=null&&t.code===n.code&&t.version===n.version&&Xn(t.multihash,n.multihash)}toString(t){return $n(this,t)}toJSON(){return{"/":$n(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(t){if(t==null)return null;let r=t;if(r instanceof e)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:o,multihash:s,bytes:i}=r;return new e(n,o,s,i??Jn(n,o,s.bytes))}else if(r[Li]===!0){let{version:n,multihash:o,code:s}=r,i=be(o);return e.create(n,s,i)}else return null}static create(t,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(t){case 0:{if(r!==ye)throw new Error(`Version 0 CID must use dag-pb (code: ${ye}) block encoding`);return new e(t,r,n,n.bytes)}case 1:{let o=Jn(t,r,n.bytes);return new e(t,r,n,o)}default:throw new Error("Invalid version")}}static createV0(t){return e.create(0,ye,t)}static createV1(t,r){return e.create(1,t,r)}static decode(t){let[r,n]=e.decodeFirst(t);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(t){let r=e.inspectBytes(t),n=r.size-r.multihashSize,o=gt(t.subarray(n,n+r.multihashSize));if(o.byteLength!==r.multihashSize)throw new Error("Incorrect length");let s=o.subarray(r.multihashSize-r.digestSize),i=new Jt(r.multihashCode,r.digestSize,s,o);return[r.version===0?e.createV0(i):e.createV1(r.codec,i),t.subarray(r.size)]}static inspectBytes(t){let r=0,n=()=>{let[u,w]=me(t.subarray(r));return r+=w,u},o=n(),s=ye;if(o===18?(o=0,r=0):s=n(),o!==0&&o!==1)throw new RangeError(`Invalid CID version ${o}`);let i=r,a=n(),c=n(),f=r+c,m=f-i;return{version:o,codec:s,multihashCode:a,digestSize:c,multihashSize:m,size:f}}static parse(t,r){let[n,o]=Ai(t,r),s=e.decode(o);if(s.version===0&&t[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return Ir(s).set(n,t),s}};function Ai(e,t){switch(e[0]){case"Q":{let r=t??Y;return[Y.prefix,r.decode(`${Y.prefix}${e}`)]}case Y.prefix:{let r=t??Y;return[Y.prefix,r.decode(e)]}case Xt.prefix:{let r=t??Xt;return[Xt.prefix,r.decode(e)]}case de.prefix:{let r=t??de;return[de.prefix,r.decode(e)]}default:{if(t==null)throw Error("To parse non base32, base36 or base58btc encoded CID multibase decoder must be provided");return[e[0],t.decode(e)]}}}function Bi(e,t,r){let{prefix:n}=r;if(n!==Y.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let o=t.get(n);if(o==null){let s=r.encode(e).slice(1);return t.set(n,s),s}else return o}function vi(e,t,r){let{prefix:n}=r,o=t.get(n);if(o==null){let s=r.encode(e);return t.set(n,s),s}else return o}var ye=112,Ii=18;function Jn(e,t,r){let n=Wt(e),o=n+Wt(t),s=new Uint8Array(o+r.byteLength);return $t(e,s,0),$t(t,s,n),s.set(r,o),s}var Li=Symbol.for("@ipld/js-cid/CID");var Lr={};st(Lr,{identity:()=>ht});var Qn=0,_i="identity",to=gt;function Di(e,t){if(t?.truncate!=null&&t.truncate!==e.byteLength){if(t.truncate<0||t.truncate>e.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${e.byteLength}`);e=e.subarray(0,t.truncate)}return Qt(Qn,to(e))}var ht={code:Qn,name:_i,encode:to,digest:Di};function lt(e,t){if(e===t)return!0;if(e.byteLength!==t.byteLength)return!1;for(let r=0;r<e.byteLength;r++)if(e[r]!==t[r])return!1;return!0}function wt(e=0){return new Uint8Array(e)}function it(e=0){return new Uint8Array(e)}function Fe(e,t){t==null&&(t=e.reduce((o,s)=>o+s.length,0));let r=it(t),n=0;for(let o of e)r.set(o,n),n+=o.length;return r}var ro=Symbol.for("@achingbrain/uint8arraylist");function eo(e,t){if(t==null||t<0)throw new RangeError("index is out of bounds");let r=0;for(let n of e){let o=r+n.byteLength;if(t<o)return{buf:n,index:t-r};r=o}throw new RangeError("index is out of bounds")}function je(e){return!!e?.[ro]}var ct=class e{bufs;length;[ro]=!0;constructor(...t){this.bufs=[],this.length=0,t.length>0&&this.appendAll(t)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...t){this.appendAll(t)}appendAll(t){let r=0;for(let n of t)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(je(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...t){this.prependAll(t)}prependAll(t){let r=0;for(let n of t.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(je(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(t){let r=eo(this.bufs,t);return r.buf[r.index]}set(t,r){let n=eo(this.bufs,t);n.buf[n.index]=r}write(t,r=0){if(t instanceof Uint8Array)for(let n=0;n<t.length;n++)this.set(r+n,t[n]);else if(je(t))for(let n=0;n<t.length;n++)this.set(r+n,t.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(t){if(t=Math.trunc(t),!(Number.isNaN(t)||t<=0)){if(t===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(t>=this.bufs[0].byteLength)t-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(t),this.length-=t;break}}}slice(t,r){let{bufs:n,length:o}=this._subList(t,r);return Fe(n,o)}subarray(t,r){let{bufs:n,length:o}=this._subList(t,r);return n.length===1?n[0]:Fe(n,o)}sublist(t,r){let{bufs:n,length:o}=this._subList(t,r),s=new e;return s.length=o,s.bufs=[...n],s}_subList(t,r){if(t=t??0,r=r??this.length,t<0&&(t=this.length+t),r<0&&(r=this.length+r),t<0||r>this.length)throw new RangeError("index is out of bounds");if(t===r)return{bufs:[],length:0};if(t===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],o=0;for(let s=0;s<this.bufs.length;s++){let i=this.bufs[s],a=o,c=a+i.byteLength;if(o=c,t>=c)continue;let f=t>=a&&t<c,m=r>a&&r<=c;if(f&&m){if(t===a&&r===c){n.push(i);break}let u=t-a;n.push(i.subarray(u,u+(r-t)));break}if(f){if(t===0){n.push(i);continue}n.push(i.subarray(t-a));continue}if(m){if(r===c){n.push(i);break}n.push(i.subarray(0,r-a));break}n.push(i)}return{bufs:n,length:r-t}}indexOf(t,r=0){if(!je(t)&&!(t instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=t instanceof Uint8Array?t:t.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),t.length===0)return r>this.length?this.length:r;let o=n.byteLength;if(o===0)throw new TypeError("search must be at least 1 byte long");let s=256,i=new Int32Array(s);for(let u=0;u<s;u++)i[u]=-1;for(let u=0;u<o;u++)i[n[u]]=u;let a=i,c=this.byteLength-n.byteLength,f=n.byteLength-1,m;for(let u=r;u<=c;u+=m){m=0;for(let w=f;w>=0;w--){let S=this.get(u+w);if(n[w]!==S){m=Math.max(1,w-a[S]);break}}if(m===0)return u}return-1}getInt8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(t,r){let n=it(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,t)}getInt16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(t,r,n){let o=wt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt16(0,r,n),this.write(o,t)}getInt32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(t,r,n){let o=wt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setInt32(0,r,n),this.write(o,t)}getBigInt64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(t,r,n){let o=wt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigInt64(0,r,n),this.write(o,t)}getUint8(t){let r=this.subarray(t,t+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(t,r){let n=it(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,t)}getUint16(t,r){let n=this.subarray(t,t+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(t,r,n){let o=wt(2);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint16(0,r,n),this.write(o,t)}getUint32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(t,r,n){let o=wt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setUint32(0,r,n),this.write(o,t)}getBigUint64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(t,r,n){let o=wt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setBigUint64(0,r,n),this.write(o,t)}getFloat32(t,r){let n=this.subarray(t,t+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(t,r,n){let o=wt(4);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat32(0,r,n),this.write(o,t)}getFloat64(t,r){let n=this.subarray(t,t+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(t,r,n){let o=wt(8);new DataView(o.buffer,o.byteOffset,o.byteLength).setFloat64(0,r,n),this.write(o,t)}equals(t){if(t==null||!(t instanceof e)||t.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!lt(this.bufs[r],t.bufs[r]))return!1;return!0}static fromUint8Arrays(t,r){let n=new e;return n.bufs=t,r==null&&(r=t.reduce((o,s)=>o+s.byteLength,0)),n.length=r,n}};var _r={};st(_r,{base10:()=>Ti});var Ti=_t({prefix:"9",name:"base10",alphabet:"0123456789"});var Dr={};st(Dr,{base16:()=>Ui,base16upper:()=>Ri});var Ui=G({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Ri=G({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Tr={};st(Tr,{base2:()=>Ci});var Ci=G({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Ur={};st(Ur,{base256emoji:()=>Pi});var no=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),Ki=no.reduce((e,t,r)=>(e[r]=t,e),[]),Ni=no.reduce((e,t,r)=>{let n=t.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${t}`);return e[n]=r,e},[]);function Oi(e){return e.reduce((t,r)=>(t+=Ki[r],t),"")}function ki(e){let t=[];for(let r of e){let n=r.codePointAt(0);if(n==null)throw new Error(`Invalid character: ${r}`);let o=Ni[n];if(o==null)throw new Error(`Non-base256emoji character: ${r}`);t.push(o)}return new Uint8Array(t)}var Pi=Yt({prefix:"\u{1F680}",name:"base256emoji",encode:Oi,decode:ki});var Rr={};st(Rr,{base64:()=>Mi,base64pad:()=>Hi,base64url:()=>qi,base64urlpad:()=>Vi});var Mi=G({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Hi=G({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),qi=G({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Vi=G({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Cr={};st(Cr,{base8:()=>Zi});var Zi=G({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Kr={};st(Kr,{identity:()=>Fi});var Fi=Yt({prefix:"\0",name:"identity",encode:e=>Vn(e),decode:e=>qn(e)});var Qa=new TextEncoder,tf=new TextDecoder;var kr={};st(kr,{sha256:()=>xe,sha512:()=>Yi});var zi=20;function Or({name:e,code:t,encode:r,minDigestLength:n,maxDigestLength:o}){return new Nr(e,t,r,n,o)}var Nr=class{name;code;encode;minDigestLength;maxDigestLength;constructor(t,r,n,o,s){this.name=t,this.code=r,this.encode=n,this.minDigestLength=o??zi,this.maxDigestLength=s}digest(t,r){if(r?.truncate!=null){if(r.truncate<this.minDigestLength)throw new Error(`Invalid truncate option, must be greater than or equal to ${this.minDigestLength}`);if(this.maxDigestLength!=null&&r.truncate>this.maxDigestLength)throw new Error(`Invalid truncate option, must be less than or equal to ${this.maxDigestLength}`)}if(t instanceof Uint8Array){let n=this.encode(t);return n instanceof Uint8Array?oo(n,this.code,r?.truncate):n.then(o=>oo(o,this.code,r?.truncate))}else throw Error("Unknown type, must be binary type")}};function oo(e,t,r){if(r!=null&&r!==e.byteLength){if(r>e.byteLength)throw new Error(`Invalid truncate option, must be less than or equal to ${e.byteLength}`);e=e.subarray(0,r)}return Qt(t,e)}function io(e){return async t=>new Uint8Array(await crypto.subtle.digest(e,t))}var xe=Or({name:"sha2-256",code:18,encode:io("SHA-256")}),Yi=Or({name:"sha2-512",code:19,encode:io("SHA-512")});var Pr={...Kr,...Tr,...Cr,..._r,...Dr,...Ar,...Br,...Sr,...Rr,...Ur},df={...kr,...Lr};function ao(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}var co=ao("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Mr=ao("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);let t=it(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),Xi={utf8:co,"utf-8":co,hex:Pr.base16,latin1:Mr,ascii:Mr,binary:Mr,...Pr},Ge=Xi;function Dt(e,t="utf8"){let r=Ge[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.decoder.decode(`${r.prefix}${e}`)}function at(e,t="utf8"){let r=Ge[t];if(r==null)throw new Error(`Unsupported encoding "${t}"`);return r.encoder.encode(e).substring(1)}var $i=parseInt("11111",2),Hr=parseInt("10000000",2),Wi=parseInt("01111111",2),fo={0:ge,1:ge,2:Ji,3:ec,4:rc,5:tc,6:Qi,16:ge,22:ge,48:ge};function qr(e,t={offset:0}){let r=e[t.offset]&$i;if(t.offset++,fo[r]!=null)return fo[r](e,t);throw new Error("No decoder for tag "+r)}function we(e,t){let r=0;if((e[t.offset]&Hr)===Hr){let n=e[t.offset]&Wi,o="0x";t.offset++;for(let s=0;s<n;s++,t.offset++)o+=e[t.offset].toString(16).padStart(2,"0");r=parseInt(o,16)}else r=e[t.offset],t.offset++;return r}function ge(e,t){we(e,t);let r=[];for(;!(t.offset>=e.byteLength);){let n=qr(e,t);if(n===null)break;r.push(n)}return r}function Ji(e,t){let r=we(e,t),n=t.offset,o=t.offset+r,s=[];for(let i=n;i<o;i++)i===n&&e[i]===0||s.push(e[i]);return t.offset+=r,Uint8Array.from(s)}function Qi(e,t){let r=we(e,t),n=t.offset+r,o=e[t.offset];t.offset++;let s=0,i=0;o<40?(s=0,i=o):o<80?(s=1,i=o-40):(s=2,i=o-80);let a=`${s}.${i}`,c=[];for(;t.offset<n;){let f=e[t.offset];if(t.offset++,c.push(f&127),f<128){c.reverse();let m=0;for(let u=0;u<c.length;u++)m+=c[u]<<u*7;a+=`.${m}`,c=[]}}return a}function tc(e,t){return t.offset++,null}function ec(e,t){let r=we(e,t),n=e[t.offset];t.offset++;let o=e.subarray(t.offset,t.offset+r-1);if(t.offset+=r,n!==0)throw new Error("Unused bits in bit string is unimplemented");return o}function rc(e,t){let r=we(e,t),n=e.subarray(t.offset,t.offset+r);return t.offset+=r,n}function nc(e){let t=e.toString(16);t.length%2===1&&(t="0"+t);let r=new ct;for(let n=0;n<t.length;n+=2)r.append(Uint8Array.from([parseInt(`${t[n]}${t[n+1]}`,16)]));return r}function Vr(e){if(e.byteLength<128)return Uint8Array.from([e.byteLength]);let t=nc(e.byteLength);return new ct(Uint8Array.from([t.byteLength|Hr]),t)}function uo(e){let t=new ct,r=128;return(e.subarray()[0]&r)===r&&t.append(Uint8Array.from([0])),t.append(e),new ct(Uint8Array.from([2]),Vr(t),t)}function ho(e){let t=Uint8Array.from([0]),r=new ct(t,e);return new ct(Uint8Array.from([3]),Vr(r),r)}function ze(e,t=48){let r=new ct;for(let n of e)r.append(n);return new ct(Uint8Array.from([t]),Vr(r),r)}async function lo(e,t,r,n){let o=await crypto.subtle.importKey("jwk",e,{name:"ECDSA",namedCurve:e.crv??"P-256"},!1,["verify"]);n?.signal?.throwIfAborted();let s=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,t,r.subarray());return n?.signal?.throwIfAborted(),s}var oc=Uint8Array.from([6,8,42,134,72,206,61,3,1,7]),sc=Uint8Array.from([6,5,43,129,4,0,34]),ic=Uint8Array.from([6,5,43,129,4,0,35]),cc={ext:!0,kty:"EC",crv:"P-256"},ac={ext:!0,kty:"EC",crv:"P-384"},fc={ext:!0,kty:"EC",crv:"P-521"},Zr=32,Fr=48,jr=66;function po(e){let t=qr(e);return mo(t)}function mo(e){let t=e[1][1][0],r=1,n,o;if(t.byteLength===Zr*2+1)return n=at(t.subarray(r,r+Zr),"base64url"),o=at(t.subarray(r+Zr),"base64url"),new ee({...cc,key_ops:["verify"],x:n,y:o});if(t.byteLength===Fr*2+1)return n=at(t.subarray(r,r+Fr),"base64url"),o=at(t.subarray(r+Fr),"base64url"),new ee({...ac,key_ops:["verify"],x:n,y:o});if(t.byteLength===jr*2+1)return n=at(t.subarray(r,r+jr),"base64url"),o=at(t.subarray(r+jr),"base64url"),new ee({...fc,key_ops:["verify"],x:n,y:o});throw new bt(`coordinates were wrong length, got ${t.byteLength}, expected 65, 97 or 133`)}function bo(e){return ze([uo(Uint8Array.from([1])),ze([uc(e.crv)],160),ze([ho(new ct(Uint8Array.from([4]),Dt(e.x??"","base64url"),Dt(e.y??"","base64url")))],161)]).subarray()}function uc(e){if(e==="P-256")return oc;if(e==="P-384")return sc;if(e==="P-521")return ic;throw new bt(`Invalid curve ${e}`)}var ee=class{type="ECDSA";jwk;_raw;constructor(t){this.jwk=t}get raw(){return this._raw==null&&(this._raw=bo(this.jwk)),this._raw}toMultihash(){return ht.digest(re(this))}toCID(){return et.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:lt(this.raw,t.raw)}async verify(t,r,n){return lo(this.jwk,r,t,n)}};function Pt(e){return e instanceof Uint8Array||ArrayBuffer.isView(e)&&e.constructor.name==="Uint8Array"}function yt(e,t=""){if(!Number.isSafeInteger(e)||e<0){let r=t&&`"${t}" `;throw new Error(`${r}expected integer >= 0, got ${e}`)}}function O(e,t,r=""){let n=Pt(e),o=e?.length,s=t!==void 0;if(!n||s&&o!==t){let i=r&&`"${r}" `,a=s?` of length ${t}`:"",c=n?`length=${o}`:`type=${typeof e}`;throw new Error(i+"expected Uint8Array"+a+", got "+c)}return e}function Ye(e){if(typeof e!="function"||typeof e.create!="function")throw new Error("Hash must wrapped by utils.createHasher");yt(e.outputLen),yt(e.blockLen)}function ne(e,t=!0){if(e.destroyed)throw new Error("Hash instance has been destroyed");if(t&&e.finished)throw new Error("Hash#digest() has already been called")}function xo(e,t){O(e,void 0,"digestInto() output");let r=t.outputLen;if(e.length<r)throw new Error('"digestInto() output" expected to be of length >='+r)}function St(...e){for(let t=0;t<e.length;t++)e[t].fill(0)}function Xe(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function dt(e,t){return e<<32-t|e>>>t}var go=typeof Uint8Array.from([]).toHex=="function"&&typeof Uint8Array.fromHex=="function",hc=Array.from({length:256},(e,t)=>t.toString(16).padStart(2,"0"));function At(e){if(O(e),go)return e.toHex();let t="";for(let r=0;r<e.length;r++)t+=hc[e[r]];return t}var Et={_0:48,_9:57,A:65,F:70,a:97,f:102};function yo(e){if(e>=Et._0&&e<=Et._9)return e-Et._0;if(e>=Et.A&&e<=Et.F)return e-(Et.A-10);if(e>=Et.a&&e<=Et.f)return e-(Et.a-10)}function Bt(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);if(go)return Uint8Array.fromHex(e);let t=e.length,r=t/2;if(t%2)throw new Error("hex string expected, got unpadded hex of length "+t);let n=new Uint8Array(r);for(let o=0,s=0;o<r;o++,s+=2){let i=yo(e.charCodeAt(s)),a=yo(e.charCodeAt(s+1));if(i===void 0||a===void 0){let c=e[s]+e[s+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+s)}n[o]=i*16+a}return n}function ot(...e){let t=0;for(let n=0;n<e.length;n++){let o=e[n];O(o),t+=o.length}let r=new Uint8Array(t);for(let n=0,o=0;n<e.length;n++){let s=e[n];r.set(s,o),o+=s.length}return r}function Gr(e,t={}){let r=(o,s)=>e(s).update(o).digest(),n=e(void 0);return r.outputLen=n.outputLen,r.blockLen=n.blockLen,r.create=o=>e(o),Object.assign(r,t),Object.freeze(r)}function oe(e=32){let t=typeof globalThis=="object"?globalThis.crypto:null;if(typeof t?.getRandomValues!="function")throw new Error("crypto.getRandomValues must be defined");return t.getRandomValues(new Uint8Array(e))}var zr=e=>({oid:Uint8Array.from([6,9,96,134,72,1,101,3,4,2,e])});function wo(e,t,r){return e&t^~e&r}function Eo(e,t,r){return e&t^e&r^t&r}var Ee=class{blockLen;outputLen;padOffset;isLE;buffer;view;finished=!1;length=0;pos=0;destroyed=!1;constructor(t,r,n,o){this.blockLen=t,this.outputLen=r,this.padOffset=n,this.isLE=o,this.buffer=new Uint8Array(t),this.view=Xe(this.buffer)}update(t){ne(this),O(t);let{view:r,buffer:n,blockLen:o}=this,s=t.length;for(let i=0;i<s;){let a=Math.min(o-this.pos,s-i);if(a===o){let c=Xe(t);for(;o<=s-i;i+=o)this.process(c,i);continue}n.set(t.subarray(i,i+a),this.pos),this.pos+=a,i+=a,this.pos===o&&(this.process(r,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){ne(this),xo(t,this),this.finished=!0;let{buffer:r,view:n,blockLen:o,isLE:s}=this,{pos:i}=this;r[i++]=128,St(this.buffer.subarray(i)),this.padOffset>o-i&&(this.process(n,0),i=0);for(let u=i;u<o;u++)r[u]=0;n.setBigUint64(o-8,BigInt(this.length*8),s),this.process(n,0);let a=Xe(t),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen must be aligned to 32bit");let f=c/4,m=this.get();if(f>m.length)throw new Error("_sha2: outputLen bigger than state");for(let u=0;u<f;u++)a.setUint32(4*u,m[u],s)}digest(){let{buffer:t,outputLen:r}=this;this.digestInto(t);let n=t.slice(0,r);return this.destroy(),n}_cloneInto(t){t||=new this.constructor,t.set(...this.get());let{blockLen:r,buffer:n,length:o,finished:s,destroyed:i,pos:a}=this;return t.destroyed=i,t.finished=s,t.length=o,t.pos=a,o%r&&t.buffer.set(n),t}clone(){return this._cloneInto()}},vt=Uint32Array.from([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]);var J=Uint32Array.from([1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209]);var $e=BigInt(4294967295),So=BigInt(32);function lc(e,t=!1){return t?{h:Number(e&$e),l:Number(e>>So&$e)}:{h:Number(e>>So&$e)|0,l:Number(e&$e)|0}}function Ao(e,t=!1){let r=e.length,n=new Uint32Array(r),o=new Uint32Array(r);for(let s=0;s<r;s++){let{h:i,l:a}=lc(e[s],t);[n[s],o[s]]=[i,a]}return[n,o]}var Yr=(e,t,r)=>e>>>r,Xr=(e,t,r)=>e<<32-r|t>>>r,Mt=(e,t,r)=>e>>>r|t<<32-r,Ht=(e,t,r)=>e<<32-r|t>>>r,Se=(e,t,r)=>e<<64-r|t>>>r-32,Ae=(e,t,r)=>e>>>r-32|t<<64-r;function xt(e,t,r,n){let o=(t>>>0)+(n>>>0);return{h:e+r+(o/2**32|0)|0,l:o|0}}var Bo=(e,t,r)=>(e>>>0)+(t>>>0)+(r>>>0),vo=(e,t,r,n)=>t+r+n+(e/2**32|0)|0,Io=(e,t,r,n)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0),Lo=(e,t,r,n,o)=>t+r+n+o+(e/2**32|0)|0,_o=(e,t,r,n,o)=>(e>>>0)+(t>>>0)+(r>>>0)+(n>>>0)+(o>>>0),Do=(e,t,r,n,o,s)=>t+r+n+o+s+(e/2**32|0)|0;var pc=Uint32Array.from([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Tt=new Uint32Array(64),$r=class extends Ee{constructor(t){super(64,t,8,!1)}get(){let{A:t,B:r,C:n,D:o,E:s,F:i,G:a,H:c}=this;return[t,r,n,o,s,i,a,c]}set(t,r,n,o,s,i,a,c){this.A=t|0,this.B=r|0,this.C=n|0,this.D=o|0,this.E=s|0,this.F=i|0,this.G=a|0,this.H=c|0}process(t,r){for(let u=0;u<16;u++,r+=4)Tt[u]=t.getUint32(r,!1);for(let u=16;u<64;u++){let w=Tt[u-15],S=Tt[u-2],p=dt(w,7)^dt(w,18)^w>>>3,v=dt(S,17)^dt(S,19)^S>>>10;Tt[u]=v+Tt[u-7]+p+Tt[u-16]|0}let{A:n,B:o,C:s,D:i,E:a,F:c,G:f,H:m}=this;for(let u=0;u<64;u++){let w=dt(a,6)^dt(a,11)^dt(a,25),S=m+w+wo(a,c,f)+pc[u]+Tt[u]|0,v=(dt(n,2)^dt(n,13)^dt(n,22))+Eo(n,o,s)|0;m=f,f=c,c=a,a=i+S|0,i=s,s=o,o=n,n=S+v|0}n=n+this.A|0,o=o+this.B|0,s=s+this.C|0,i=i+this.D|0,a=a+this.E|0,c=c+this.F|0,f=f+this.G|0,m=m+this.H|0,this.set(n,o,s,i,a,c,f,m)}roundClean(){St(Tt)}destroy(){this.set(0,0,0,0,0,0,0,0),St(this.buffer)}},Wr=class extends $r{A=vt[0]|0;B=vt[1]|0;C=vt[2]|0;D=vt[3]|0;E=vt[4]|0;F=vt[5]|0;G=vt[6]|0;H=vt[7]|0;constructor(){super(32)}};var To=Ao(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(e=>BigInt(e))),mc=To[0],bc=To[1],Ut=new Uint32Array(80),Rt=new Uint32Array(80),Jr=class extends Ee{constructor(t){super(128,t,16,!1)}get(){let{Ah:t,Al:r,Bh:n,Bl:o,Ch:s,Cl:i,Dh:a,Dl:c,Eh:f,El:m,Fh:u,Fl:w,Gh:S,Gl:p,Hh:v,Hl:A}=this;return[t,r,n,o,s,i,a,c,f,m,u,w,S,p,v,A]}set(t,r,n,o,s,i,a,c,f,m,u,w,S,p,v,A){this.Ah=t|0,this.Al=r|0,this.Bh=n|0,this.Bl=o|0,this.Ch=s|0,this.Cl=i|0,this.Dh=a|0,this.Dl=c|0,this.Eh=f|0,this.El=m|0,this.Fh=u|0,this.Fl=w|0,this.Gh=S|0,this.Gl=p|0,this.Hh=v|0,this.Hl=A|0}process(t,r){for(let y=0;y<16;y++,r+=4)Ut[y]=t.getUint32(r),Rt[y]=t.getUint32(r+=4);for(let y=16;y<80;y++){let I=Ut[y-15]|0,C=Rt[y-15]|0,k=Mt(I,C,1)^Mt(I,C,8)^Yr(I,C,7),P=Ht(I,C,1)^Ht(I,C,8)^Xr(I,C,7),g=Ut[y-2]|0,x=Rt[y-2]|0,K=Mt(g,x,19)^Se(g,x,61)^Yr(g,x,6),M=Ht(g,x,19)^Ae(g,x,61)^Xr(g,x,6),T=Io(P,M,Rt[y-7],Rt[y-16]),l=Lo(T,k,K,Ut[y-7],Ut[y-16]);Ut[y]=l|0,Rt[y]=T|0}let{Ah:n,Al:o,Bh:s,Bl:i,Ch:a,Cl:c,Dh:f,Dl:m,Eh:u,El:w,Fh:S,Fl:p,Gh:v,Gl:A,Hh:b,Hl:B}=this;for(let y=0;y<80;y++){let I=Mt(u,w,14)^Mt(u,w,18)^Se(u,w,41),C=Ht(u,w,14)^Ht(u,w,18)^Ae(u,w,41),k=u&S^~u&v,P=w&p^~w&A,g=_o(B,C,P,bc[y],Rt[y]),x=Do(g,b,I,k,mc[y],Ut[y]),K=g|0,M=Mt(n,o,28)^Se(n,o,34)^Se(n,o,39),T=Ht(n,o,28)^Ae(n,o,34)^Ae(n,o,39),l=n&s^n&a^s&a,d=o&i^o&c^i&c;b=v|0,B=A|0,v=S|0,A=p|0,S=u|0,p=w|0,{h:u,l:w}=xt(f|0,m|0,x|0,K|0),f=a|0,m=c|0,a=s|0,c=i|0,s=n|0,i=o|0;let h=Bo(K,T,d);n=vo(h,x,M,l),o=h|0}({h:n,l:o}=xt(this.Ah|0,this.Al|0,n|0,o|0)),{h:s,l:i}=xt(this.Bh|0,this.Bl|0,s|0,i|0),{h:a,l:c}=xt(this.Ch|0,this.Cl|0,a|0,c|0),{h:f,l:m}=xt(this.Dh|0,this.Dl|0,f|0,m|0),{h:u,l:w}=xt(this.Eh|0,this.El|0,u|0,w|0),{h:S,l:p}=xt(this.Fh|0,this.Fl|0,S|0,p|0),{h:v,l:A}=xt(this.Gh|0,this.Gl|0,v|0,A|0),{h:b,l:B}=xt(this.Hh|0,this.Hl|0,b|0,B|0),this.set(n,o,s,i,a,c,f,m,u,w,S,p,v,A,b,B)}roundClean(){St(Ut,Rt)}destroy(){St(this.buffer),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}},Qr=class extends Jr{Ah=J[0]|0;Al=J[1]|0;Bh=J[2]|0;Bl=J[3]|0;Ch=J[4]|0;Cl=J[5]|0;Dh=J[6]|0;Dl=J[7]|0;Eh=J[8]|0;El=J[9]|0;Fh=J[10]|0;Fl=J[11]|0;Gh=J[12]|0;Gl=J[13]|0;Hh=J[14]|0;Hl=J[15]|0;constructor(){super(64)}};var Uo=Gr(()=>new Wr,zr(1));var Ro=Gr(()=>new Qr,zr(3));var en=BigInt(0),tn=BigInt(1);function It(e,t=""){if(typeof e!="boolean"){let r=t&&`"${t}" `;throw new Error(r+"expected boolean, got type="+typeof e)}return e}function Co(e){if(typeof e=="bigint"){if(!We(e))throw new Error("positive bigint expected, got "+e)}else yt(e);return e}function Be(e){let t=Co(e).toString(16);return t.length&1?"0"+t:t}function Ko(e){if(typeof e!="string")throw new Error("hex string expected, got "+typeof e);return e===""?en:BigInt("0x"+e)}function se(e){return Ko(At(e))}function qt(e){return Ko(At(Qe(O(e)).reverse()))}function Je(e,t){yt(t),e=Co(e);let r=Bt(e.toString(16).padStart(t*2,"0"));if(r.length!==t)throw new Error("number too large");return r}function rn(e,t){return Je(e,t).reverse()}function Qe(e){return Uint8Array.from(e)}var We=e=>typeof e=="bigint"&&en<=e;function yc(e,t,r){return We(e)&&We(t)&&We(r)&&t<=e&&e<r}function ve(e,t,r,n){if(!yc(t,r,n))throw new Error("expected valid "+e+": "+r+" <= n < "+n+", got "+t)}function nn(e){let t;for(t=0;e>en;e>>=tn,t+=1);return t}var Ie=e=>(tn<<BigInt(e))-tn;function No(e,t,r){if(yt(e,"hashLen"),yt(t,"qByteLen"),typeof r!="function")throw new Error("hmacFn must be a function");let n=A=>new Uint8Array(A),o=Uint8Array.of(),s=Uint8Array.of(0),i=Uint8Array.of(1),a=1e3,c=n(e),f=n(e),m=0,u=()=>{c.fill(1),f.fill(0),m=0},w=(...A)=>r(f,ot(c,...A)),S=(A=o)=>{f=w(s,A),c=w(),A.length!==0&&(f=w(i,A),c=w())},p=()=>{if(m++>=a)throw new Error("drbg: tried max amount of iterations");let A=0,b=[];for(;A<t;){c=w();let B=c.slice();b.push(B),A+=c.length}return ot(...b)};return(A,b)=>{u(),S(A);let B;for(;!(B=b(p()));)S();return u(),B}}function Ct(e,t={},r={}){if(!e||typeof e!="object")throw new Error("expected valid options object");function n(s,i,a){let c=e[s];if(a&&c===void 0)return;let f=typeof c;if(f!==i||c===null)throw new Error(`param "${s}" is invalid: expected ${i}, got ${f}`)}let o=(s,i)=>Object.entries(s).forEach(([a,c])=>n(a,c,i));o(t,!1),o(r,!0)}function ie(e){let t=new WeakMap;return(r,...n)=>{let o=t.get(r);if(o!==void 0)return o;let s=e(r,...n);return t.set(r,s),s}}var rt=BigInt(0),X=BigInt(1),Vt=BigInt(2),Po=BigInt(3),Mo=BigInt(4),Ho=BigInt(5),xc=BigInt(7),qo=BigInt(8),gc=BigInt(9),Vo=BigInt(16);function z(e,t){let r=e%t;return r>=rt?r:t+r}function V(e,t,r){let n=e;for(;t-- >rt;)n*=n,n%=r;return n}function Oo(e,t){if(e===rt)throw new Error("invert: expected non-zero number");if(t<=rt)throw new Error("invert: expected positive modulus, got "+t);let r=z(e,t),n=t,o=rt,s=X,i=X,a=rt;for(;r!==rt;){let f=n/r,m=n%r,u=o-i*f,w=s-a*f;n=r,r=m,o=i,s=a,i=u,a=w}if(n!==X)throw new Error("invert: does not exist");return z(o,t)}function sn(e,t,r){if(!e.eql(e.sqr(t),r))throw new Error("Cannot find square root")}function Zo(e,t){let r=(e.ORDER+X)/Mo,n=e.pow(t,r);return sn(e,n,t),n}function wc(e,t){let r=(e.ORDER-Ho)/qo,n=e.mul(t,Vt),o=e.pow(n,r),s=e.mul(t,o),i=e.mul(e.mul(s,Vt),o),a=e.mul(s,e.sub(i,e.ONE));return sn(e,a,t),a}function Ec(e){let t=ce(e),r=Fo(e),n=r(t,t.neg(t.ONE)),o=r(t,n),s=r(t,t.neg(n)),i=(e+xc)/Vo;return(a,c)=>{let f=a.pow(c,i),m=a.mul(f,n),u=a.mul(f,o),w=a.mul(f,s),S=a.eql(a.sqr(m),c),p=a.eql(a.sqr(u),c);f=a.cmov(f,m,S),m=a.cmov(w,u,p);let v=a.eql(a.sqr(m),c),A=a.cmov(f,m,v);return sn(a,A,c),A}}function Fo(e){if(e<Po)throw new Error("sqrt is not defined for small field");let t=e-X,r=0;for(;t%Vt===rt;)t/=Vt,r++;let n=Vt,o=ce(e);for(;ko(o,n)===1;)if(n++>1e3)throw new Error("Cannot find square root: probably non-prime P");if(r===1)return Zo;let s=o.pow(n,t),i=(t+X)/Vt;return function(c,f){if(c.is0(f))return f;if(ko(c,f)!==1)throw new Error("Cannot find square root");let m=r,u=c.mul(c.ONE,s),w=c.pow(f,t),S=c.pow(f,i);for(;!c.eql(w,c.ONE);){if(c.is0(w))return c.ZERO;let p=1,v=c.sqr(w);for(;!c.eql(v,c.ONE);)if(p++,v=c.sqr(v),p===m)throw new Error("Cannot find square root");let A=X<<BigInt(m-p-1),b=c.pow(u,A);m=p,u=c.sqr(b),w=c.mul(w,u),S=c.mul(S,b)}return S}}function Sc(e){return e%Mo===Po?Zo:e%qo===Ho?wc:e%Vo===gc?Ec(e):Fo(e)}var jo=(e,t)=>(z(e,t)&X)===X,Ac=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cn(e){let t={ORDER:"bigint",BYTES:"number",BITS:"number"},r=Ac.reduce((n,o)=>(n[o]="function",n),t);return Ct(e,r),e}function Bc(e,t,r){if(r<rt)throw new Error("invalid exponent, negatives unsupported");if(r===rt)return e.ONE;if(r===X)return t;let n=e.ONE,o=t;for(;r>rt;)r&X&&(n=e.mul(n,o)),o=e.sqr(o),r>>=X;return n}function Le(e,t,r=!1){let n=new Array(t.length).fill(r?e.ZERO:void 0),o=t.reduce((i,a,c)=>e.is0(a)?i:(n[c]=i,e.mul(i,a)),e.ONE),s=e.inv(o);return t.reduceRight((i,a,c)=>e.is0(a)?i:(n[c]=e.mul(i,n[c]),e.mul(i,a)),s),n}function ko(e,t){let r=(e.ORDER-X)/Vt,n=e.pow(t,r),o=e.eql(n,e.ONE),s=e.eql(n,e.ZERO),i=e.eql(n,e.neg(e.ONE));if(!o&&!s&&!i)throw new Error("invalid Legendre symbol result");return o?1:s?0:-1}function vc(e,t){t!==void 0&&yt(t);let r=t!==void 0?t:e.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}var on=class{ORDER;BITS;BYTES;isLE;ZERO=rt;ONE=X;_lengths;_sqrt;_mod;constructor(t,r={}){if(t<=rt)throw new Error("invalid field: expected ORDER > 0, got "+t);let n;this.isLE=!1,r!=null&&typeof r=="object"&&(typeof r.BITS=="number"&&(n=r.BITS),typeof r.sqrt=="function"&&(this.sqrt=r.sqrt),typeof r.isLE=="boolean"&&(this.isLE=r.isLE),r.allowedLengths&&(this._lengths=r.allowedLengths?.slice()),typeof r.modFromBytes=="boolean"&&(this._mod=r.modFromBytes));let{nBitLength:o,nByteLength:s}=vc(t,n);if(s>2048)throw new Error("invalid field: expected ORDER of <= 2048 bytes");this.ORDER=t,this.BITS=o,this.BYTES=s,this._sqrt=void 0,Object.preventExtensions(this)}create(t){return z(t,this.ORDER)}isValid(t){if(typeof t!="bigint")throw new Error("invalid field element: expected bigint, got "+typeof t);return rt<=t&&t<this.ORDER}is0(t){return t===rt}isValidNot0(t){return!this.is0(t)&&this.isValid(t)}isOdd(t){return(t&X)===X}neg(t){return z(-t,this.ORDER)}eql(t,r){return t===r}sqr(t){return z(t*t,this.ORDER)}add(t,r){return z(t+r,this.ORDER)}sub(t,r){return z(t-r,this.ORDER)}mul(t,r){return z(t*r,this.ORDER)}pow(t,r){return Bc(this,t,r)}div(t,r){return z(t*Oo(r,this.ORDER),this.ORDER)}sqrN(t){return t*t}addN(t,r){return t+r}subN(t,r){return t-r}mulN(t,r){return t*r}inv(t){return Oo(t,this.ORDER)}sqrt(t){return this._sqrt||(this._sqrt=Sc(this.ORDER)),this._sqrt(this,t)}toBytes(t){return this.isLE?rn(t,this.BYTES):Je(t,this.BYTES)}fromBytes(t,r=!1){O(t);let{_lengths:n,BYTES:o,isLE:s,ORDER:i,_mod:a}=this;if(n){if(!n.includes(t.length)||t.length>o)throw new Error("Field.fromBytes: expected "+n+" bytes, got "+t.length);let f=new Uint8Array(o);f.set(t,s?0:f.length-t.length),t=f}if(t.length!==o)throw new Error("Field.fromBytes: expected "+o+" bytes, got "+t.length);let c=s?qt(t):se(t);if(a&&(c=z(c,i)),!r&&!this.isValid(c))throw new Error("invalid field element: outside of range 0..ORDER");return c}invertBatch(t){return Le(this,t)}cmov(t,r,n){return n?r:t}};function ce(e,t={}){return new on(e,t)}function Go(e){if(typeof e!="bigint")throw new Error("field order must be bigint");let t=e.toString(2).length;return Math.ceil(t/8)}function an(e){let t=Go(e);return t+Math.ceil(t/2)}function fn(e,t,r=!1){O(e);let n=e.length,o=Go(t),s=an(t);if(n<16||n<s||n>1024)throw new Error("expected "+s+"-1024 bytes of input, got "+n);let i=r?qt(e):se(e),a=z(i,t-X)+X;return r?rn(a,o):Je(a,o)}var ae=BigInt(0),Zt=BigInt(1);function _e(e,t){let r=t.negate();return e?r:t}function Ft(e,t){let r=Le(e.Fp,t.map(n=>n.Z));return t.map((n,o)=>e.fromAffine(n.toAffine(r[o])))}function $o(e,t){if(!Number.isSafeInteger(e)||e<=0||e>t)throw new Error("invalid window size, expected [1.."+t+"], got W="+e)}function un(e,t){$o(e,t);let r=Math.ceil(t/e)+1,n=2**(e-1),o=2**e,s=Ie(e),i=BigInt(e);return{windows:r,windowSize:n,mask:s,maxNumber:o,shiftBy:i}}function zo(e,t,r){let{windowSize:n,mask:o,maxNumber:s,shiftBy:i}=r,a=Number(e&o),c=e>>i;a>n&&(a-=s,c+=Zt);let f=t*n,m=f+Math.abs(a)-1,u=a===0,w=a<0,S=t%2!==0;return{nextN:c,offset:m,isZero:u,isNeg:w,isNegF:S,offsetF:f}}var hn=new WeakMap,Wo=new WeakMap;function ln(e){return Wo.get(e)||1}function Yo(e){if(e!==ae)throw new Error("invalid wNAF")}var fe=class{BASE;ZERO;Fn;bits;constructor(t,r){this.BASE=t.BASE,this.ZERO=t.ZERO,this.Fn=t.Fn,this.bits=r}_unsafeLadder(t,r,n=this.ZERO){let o=t;for(;r>ae;)r&Zt&&(n=n.add(o)),o=o.double(),r>>=Zt;return n}precomputeWindow(t,r){let{windows:n,windowSize:o}=un(r,this.bits),s=[],i=t,a=i;for(let c=0;c<n;c++){a=i,s.push(a);for(let f=1;f<o;f++)a=a.add(i),s.push(a);i=a.double()}return s}wNAF(t,r,n){if(!this.Fn.isValid(n))throw new Error("invalid scalar");let o=this.ZERO,s=this.BASE,i=un(t,this.bits);for(let a=0;a<i.windows;a++){let{nextN:c,offset:f,isZero:m,isNeg:u,isNegF:w,offsetF:S}=zo(n,a,i);n=c,m?s=s.add(_e(w,r[S])):o=o.add(_e(u,r[f]))}return Yo(n),{p:o,f:s}}wNAFUnsafe(t,r,n,o=this.ZERO){let s=un(t,this.bits);for(let i=0;i<s.windows&&n!==ae;i++){let{nextN:a,offset:c,isZero:f,isNeg:m}=zo(n,i,s);if(n=a,!f){let u=r[c];o=o.add(m?u.negate():u)}}return Yo(n),o}getPrecomputes(t,r,n){let o=hn.get(r);return o||(o=this.precomputeWindow(r,t),t!==1&&(typeof n=="function"&&(o=n(o)),hn.set(r,o))),o}cached(t,r,n){let o=ln(t);return this.wNAF(o,this.getPrecomputes(o,t,n),r)}unsafe(t,r,n,o){let s=ln(t);return s===1?this._unsafeLadder(t,r,o):this.wNAFUnsafe(s,this.getPrecomputes(s,t,n),r,o)}createCache(t,r){$o(r,this.bits),Wo.set(t,r),hn.delete(t)}hasCache(t){return ln(t)!==1}};function Jo(e,t,r,n){let o=t,s=e.ZERO,i=e.ZERO;for(;r>ae||n>ae;)r&Zt&&(s=s.add(o)),n&Zt&&(i=i.add(o)),o=o.double(),r>>=Zt,n>>=Zt;return{p1:s,p2:i}}function Xo(e,t,r){if(t){if(t.ORDER!==e)throw new Error("Field.ORDER must match order: Fp == p, Fn == n");return cn(t),t}else return ce(e,{isLE:r})}function tr(e,t,r={},n){if(n===void 0&&(n=e==="edwards"),!t||typeof t!="object")throw new Error(`expected valid ${e} CURVE object`);for(let c of["p","n","h"]){let f=t[c];if(!(typeof f=="bigint"&&f>ae))throw new Error(`CURVE.${c} must be positive bigint`)}let o=Xo(t.p,r.Fp,n),s=Xo(t.n,r.Fn,n),a=["Gx","Gy","a",e==="weierstrass"?"b":"d"];for(let c of a)if(!o.isValid(t[c]))throw new Error(`CURVE.${c} must be valid field element of CURVE.Fp`);return t=Object.freeze(Object.assign({},t)),{CURVE:t,Fp:o,Fn:s}}function er(e,t){return function(n){let o=e(n);return{secretKey:o,publicKey:t(o)}}}var Kt=BigInt(0),$=BigInt(1),dn=BigInt(2),Ic=BigInt(8);function Lc(e,t,r,n){let o=e.sqr(r),s=e.sqr(n),i=e.add(e.mul(t.a,o),s),a=e.add(e.ONE,e.mul(t.d,e.mul(o,s)));return e.eql(i,a)}function Qo(e,t={}){let r=tr("edwards",e,t,t.FpFnLE),{Fp:n,Fn:o}=r,s=r.CURVE,{h:i}=s;Ct(t,{},{uvRatio:"function"});let a=dn<<BigInt(o.BYTES*8)-$,c=A=>n.create(A),f=t.uvRatio||((A,b)=>{try{return{isValid:!0,value:n.sqrt(n.div(A,b))}}catch{return{isValid:!1,value:Kt}}});if(!Lc(n,s,s.Gx,s.Gy))throw new Error("bad curve params: generator point");function m(A,b,B=!1){let y=B?$:Kt;return ve("coordinate "+A,b,y,a),b}function u(A){if(!(A instanceof p))throw new Error("EdwardsPoint expected")}let w=ie((A,b)=>{let{X:B,Y:y,Z:I}=A,C=A.is0();b==null&&(b=C?Ic:n.inv(I));let k=c(B*b),P=c(y*b),g=n.mul(I,b);if(C)return{x:Kt,y:$};if(g!==$)throw new Error("invZ was invalid");return{x:k,y:P}}),S=ie(A=>{let{a:b,d:B}=s;if(A.is0())throw new Error("bad point: ZERO");let{X:y,Y:I,Z:C,T:k}=A,P=c(y*y),g=c(I*I),x=c(C*C),K=c(x*x),M=c(P*b),T=c(x*c(M+g)),l=c(K+c(B*c(P*g)));if(T!==l)throw new Error("bad point: equation left != right (1)");let d=c(y*I),h=c(C*k);if(d!==h)throw new Error("bad point: equation left != right (2)");return!0});class p{static BASE=new p(s.Gx,s.Gy,$,c(s.Gx*s.Gy));static ZERO=new p(Kt,$,$,Kt);static Fp=n;static Fn=o;X;Y;Z;T;constructor(b,B,y,I){this.X=m("x",b),this.Y=m("y",B),this.Z=m("z",y,!0),this.T=m("t",I),Object.freeze(this)}static CURVE(){return s}static fromAffine(b){if(b instanceof p)throw new Error("extended point not allowed");let{x:B,y}=b||{};return m("x",B),m("y",y),new p(B,y,$,c(B*y))}static fromBytes(b,B=!1){let y=n.BYTES,{a:I,d:C}=s;b=Qe(O(b,y,"point")),It(B,"zip215");let k=Qe(b),P=b[y-1];k[y-1]=P&-129;let g=qt(k),x=B?a:n.ORDER;ve("point.y",g,Kt,x);let K=c(g*g),M=c(K-$),T=c(C*K-I),{isValid:l,value:d}=f(M,T);if(!l)throw new Error("bad point: invalid y coordinate");let h=(d&$)===$,E=(P&128)!==0;if(!B&&d===Kt&&E)throw new Error("bad point: x=0 and x_0=1");return E!==h&&(d=c(-d)),p.fromAffine({x:d,y:g})}static fromHex(b,B=!1){return p.fromBytes(Bt(b),B)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(b=8,B=!0){return v.createCache(this,b),B||this.multiply(dn),this}assertValidity(){S(this)}equals(b){u(b);let{X:B,Y:y,Z:I}=this,{X:C,Y:k,Z:P}=b,g=c(B*P),x=c(C*I),K=c(y*P),M=c(k*I);return g===x&&K===M}is0(){return this.equals(p.ZERO)}negate(){return new p(c(-this.X),this.Y,this.Z,c(-this.T))}double(){let{a:b}=s,{X:B,Y:y,Z:I}=this,C=c(B*B),k=c(y*y),P=c(dn*c(I*I)),g=c(b*C),x=B+y,K=c(c(x*x)-C-k),M=g+k,T=M-P,l=g-k,d=c(K*T),h=c(M*l),E=c(K*l),L=c(T*M);return new p(d,h,L,E)}add(b){u(b);let{a:B,d:y}=s,{X:I,Y:C,Z:k,T:P}=this,{X:g,Y:x,Z:K,T:M}=b,T=c(I*g),l=c(C*x),d=c(P*y*M),h=c(k*K),E=c((I+C)*(g+x)-T-l),L=h-d,D=h+d,U=c(l-B*T),_=c(E*L),R=c(D*U),N=c(E*U),Z=c(L*D);return new p(_,R,Z,N)}subtract(b){return this.add(b.negate())}multiply(b){if(!o.isValidNot0(b))throw new Error("invalid scalar: expected 1 <= sc < curve.n");let{p:B,f:y}=v.cached(this,b,I=>Ft(p,I));return Ft(p,[B,y])[0]}multiplyUnsafe(b,B=p.ZERO){if(!o.isValid(b))throw new Error("invalid scalar: expected 0 <= sc < curve.n");return b===Kt?p.ZERO:this.is0()||b===$?this:v.unsafe(this,b,y=>Ft(p,y),B)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}isTorsionFree(){return v.unsafe(this,s.n).is0()}toAffine(b){return w(this,b)}clearCofactor(){return i===$?this:this.multiplyUnsafe(i)}toBytes(){let{x:b,y:B}=this.toAffine(),y=n.toBytes(B);return y[y.length-1]|=b&$?128:0,y}toHex(){return At(this.toBytes())}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let v=new fe(p,o.BITS);return p.BASE.precompute(8),p}function ts(e,t,r={}){if(typeof t!="function")throw new Error('"hash" function param is required');Ct(r,{},{adjustScalarBytes:"function",randomBytes:"function",domain:"function",prehash:"function",mapToCurve:"function"});let{prehash:n}=r,{BASE:o,Fp:s,Fn:i}=e,a=r.randomBytes||oe,c=r.adjustScalarBytes||(g=>g),f=r.domain||((g,x,K)=>{if(It(K,"phflag"),x.length||K)throw new Error("Contexts/pre-hash are not supported");return g});function m(g){return i.create(qt(g))}function u(g){let x=y.secretKey;O(g,y.secretKey,"secretKey");let K=O(t(g),2*x,"hashedSecretKey"),M=c(K.slice(0,x)),T=K.slice(x,2*x),l=m(M);return{head:M,prefix:T,scalar:l}}function w(g){let{head:x,prefix:K,scalar:M}=u(g),T=o.multiply(M),l=T.toBytes();return{head:x,prefix:K,scalar:M,point:T,pointBytes:l}}function S(g){return w(g).pointBytes}function p(g=Uint8Array.of(),...x){let K=ot(...x);return m(t(f(K,O(g,void 0,"context"),!!n)))}function v(g,x,K={}){g=O(g,void 0,"message"),n&&(g=n(g));let{prefix:M,scalar:T,pointBytes:l}=w(x),d=p(K.context,M,g),h=o.multiply(d).toBytes(),E=p(K.context,h,l,g),L=i.create(d+E*T);if(!i.isValid(L))throw new Error("sign failed: invalid s");let D=ot(h,i.toBytes(L));return O(D,y.signature,"result")}let A={zip215:!0};function b(g,x,K,M=A){let{context:T,zip215:l}=M,d=y.signature;g=O(g,d,"signature"),x=O(x,void 0,"message"),K=O(K,y.publicKey,"publicKey"),l!==void 0&&It(l,"zip215"),n&&(x=n(x));let h=d/2,E=g.subarray(0,h),L=qt(g.subarray(h,d)),D,U,_;try{D=e.fromBytes(K,l),U=e.fromBytes(E,l),_=o.multiplyUnsafe(L)}catch{return!1}if(!l&&D.isSmallOrder())return!1;let R=p(T,U.toBytes(),D.toBytes(),x);return U.add(D.multiplyUnsafe(R)).subtract(_).clearCofactor().is0()}let B=s.BYTES,y={secretKey:B,publicKey:B,signature:2*B,seed:B};function I(g=a(y.seed)){return O(g,y.seed,"seed")}function C(g){return Pt(g)&&g.length===i.BYTES}function k(g,x){try{return!!e.fromBytes(g,x)}catch{return!1}}let P={getExtendedPublicKey:w,randomSecretKey:I,isValidSecretKey:C,isValidPublicKey:k,toMontgomery(g){let{y:x}=e.fromBytes(g),K=y.publicKey,M=K===32;if(!M&&K!==57)throw new Error("only defined for 25519 and 448");let T=M?s.div($+x,$-x):s.div(x-$,x+$);return s.toBytes(T)},toMontgomerySecret(g){let x=y.secretKey;O(g,x);let K=t(g.subarray(0,x));return c(K).subarray(0,x)}};return Object.freeze({keygen:er(I,S),getPublicKey:S,sign:v,verify:b,utils:P,Point:e,lengths:y})}var _c=BigInt(1),es=BigInt(2);var Dc=BigInt(5),Tc=BigInt(8),pn=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffed"),Uc={p:pn,n:BigInt("0x1000000000000000000000000000000014def9dea2f79cd65812631a5cf5d3ed"),h:Tc,a:BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffec"),d:BigInt("0x52036cee2b6ffe738cc740797779e89800700a4d4141d8ab75eb4dca135978a3"),Gx:BigInt("0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a"),Gy:BigInt("0x6666666666666666666666666666666666666666666666666666666666666658")};function Rc(e){let t=BigInt(10),r=BigInt(20),n=BigInt(40),o=BigInt(80),s=pn,a=e*e%s*e%s,c=V(a,es,s)*a%s,f=V(c,_c,s)*e%s,m=V(f,Dc,s)*f%s,u=V(m,t,s)*m%s,w=V(u,r,s)*u%s,S=V(w,n,s)*w%s,p=V(S,o,s)*S%s,v=V(p,o,s)*S%s,A=V(v,t,s)*m%s;return{pow_p_5_8:V(A,es,s)*e%s,b2:a}}function Cc(e){return e[0]&=248,e[31]&=127,e[31]|=64,e}var rs=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752");function Kc(e,t){let r=pn,n=z(t*t*t,r),o=z(n*n*t,r),s=Rc(e*o).pow_p_5_8,i=z(e*n*s,r),a=z(t*i*i,r),c=i,f=z(i*rs,r),m=a===e,u=a===z(-e,r),w=a===z(-e*rs,r);return m&&(i=c),(u||w)&&(i=f),jo(i,r)&&(i=z(-i,r)),{isValid:m||u,value:i}}var Nc=Qo(Uc,{uvRatio:Kc});function Oc(e){return ts(Nc,Ro,Object.assign({adjustScalarBytes:Cc},e))}var ns=Oc({});var De=class extends Error{constructor(t="An error occurred while verifying a message"){super(t),this.name="VerificationError"}},rr=class extends Error{constructor(t="Missing Web Crypto API"){super(t),this.name="WebCryptoMissingError"}};var os={get(e=globalThis){let t=e.crypto;if(t?.subtle==null)throw new rr("Missing Web Crypto API. The most likely cause of this error is that this page is being accessed from an insecure context (i.e. not HTTPS). For more information and possible resolutions see https://github.com/libp2p/js-libp2p/blob/main/packages/crypto/README.md#web-crypto-api");return t}};var nr=os;var or=32;var mn,kc=(async()=>{try{return await nr.get().subtle.generateKey({name:"Ed25519"},!0,["sign","verify"]),!0}catch{return!1}})();async function Pc(e,t,r){if(e.buffer instanceof ArrayBuffer){let n=await nr.get().subtle.importKey("raw",e.buffer,{name:"Ed25519"},!1,["verify"]);return await nr.get().subtle.verify({name:"Ed25519"},n,t,r instanceof Uint8Array?r:r.subarray())}throw new TypeError("WebCrypto does not support SharedArrayBuffer for Ed25519 keys")}function Mc(e,t,r){return ns.verify(t,r instanceof Uint8Array?r:r.subarray(),e)}async function ss(e,t,r){return mn==null&&(mn=await kc),mn?Pc(e,t,r):Mc(e,t,r)}function sr(e){return e==null?!1:typeof e.then=="function"&&typeof e.catch=="function"&&typeof e.finally=="function"}var ir=class{type="Ed25519";raw;constructor(t){this.raw=bn(t,or)}toMultihash(){return ht.digest(re(this))}toCID(){return et.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:lt(this.raw,t.raw)}verify(t,r,n){n?.signal?.throwIfAborted();let o=ss(this.raw,r,t);return sr(o)?o.then(s=>(n?.signal?.throwIfAborted(),s)):o}};function cs(e){return e=bn(e,or),new ir(e)}function bn(e,t){if(e=Uint8Array.from(e??[]),e.length!==t)throw new bt(`Key must be a Uint8Array of length ${t}, got ${e.length}`);return e}var qc=Math.pow(2,7),Vc=Math.pow(2,14),Zc=Math.pow(2,21),as=Math.pow(2,28),fs=Math.pow(2,35),us=Math.pow(2,42),hs=Math.pow(2,49),nt=128,Nt=127;function Te(e){if(e<qc)return 1;if(e<Vc)return 2;if(e<Zc)return 3;if(e<as)return 4;if(e<fs)return 5;if(e<us)return 6;if(e<hs)return 7;if(Number.MAX_SAFE_INTEGER!=null&&e>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function ls(e,t,r=0){switch(Te(e)){case 8:t[r++]=e&255|nt,e/=128;case 7:t[r++]=e&255|nt,e/=128;case 6:t[r++]=e&255|nt,e/=128;case 5:t[r++]=e&255|nt,e/=128;case 4:t[r++]=e&255|nt,e>>>=7;case 3:t[r++]=e&255|nt,e>>>=7;case 2:t[r++]=e&255|nt,e>>>=7;case 1:{t[r++]=e&255,e>>>=7;break}default:throw new Error("unreachable")}return t}function ds(e,t){let r=e[t],n=0;if(n+=r&Nt,r<nt||(r=e[t+1],n+=(r&Nt)<<7,r<nt)||(r=e[t+2],n+=(r&Nt)<<14,r<nt)||(r=e[t+3],n+=(r&Nt)<<21,r<nt)||(r=e[t+4],n+=(r&Nt)*as,r<nt)||(r=e[t+5],n+=(r&Nt)*fs,r<nt)||(r=e[t+6],n+=(r&Nt)*us,r<nt)||(r=e[t+7],n+=(r&Nt)*hs,r<nt))return n;throw new RangeError("Could not decode varint")}var yn=new Float32Array([-0]),Ot=new Uint8Array(yn.buffer);function ps(e,t,r){yn[0]=e,t[r]=Ot[0],t[r+1]=Ot[1],t[r+2]=Ot[2],t[r+3]=Ot[3]}function ms(e,t){return Ot[0]=e[t],Ot[1]=e[t+1],Ot[2]=e[t+2],Ot[3]=e[t+3],yn[0]}var xn=new Float64Array([-0]),tt=new Uint8Array(xn.buffer);function bs(e,t,r){xn[0]=e,t[r]=tt[0],t[r+1]=tt[1],t[r+2]=tt[2],t[r+3]=tt[3],t[r+4]=tt[4],t[r+5]=tt[5],t[r+6]=tt[6],t[r+7]=tt[7]}function ys(e,t){return tt[0]=e[t],tt[1]=e[t+1],tt[2]=e[t+2],tt[3]=e[t+3],tt[4]=e[t+4],tt[5]=e[t+5],tt[6]=e[t+6],tt[7]=e[t+7],xn[0]}var Fc=BigInt(Number.MAX_SAFE_INTEGER),jc=BigInt(Number.MIN_SAFE_INTEGER),ft=class e{lo;hi;constructor(t,r){this.lo=t|0,this.hi=r|0}toNumber(t=!1){if(!t&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(t=!1){if(t)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(t=!1){return this.toBigInt(t).toString()}zzEncode(){let t=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^t)>>>0,this.lo=(this.lo<<1^t)>>>0,this}zzDecode(){let t=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^t)>>>0,this.hi=(this.hi>>>1^t)>>>0,this}length(){let t=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?t<16384?t<128?1:2:t<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(t){if(t===0n)return jt;if(t<Fc&&t>jc)return this.fromNumber(Number(t));let r=t<0n;r&&(t=-t);let n=t>>32n,o=t-(n<<32n);return r&&(n=~n|0n,o=~o|0n,++o>xs&&(o=0n,++n>xs&&(n=0n))),new e(Number(o),Number(n))}static fromNumber(t){if(t===0)return jt;let r=t<0;r&&(t=-t);let n=t>>>0,o=(t-n)/4294967296>>>0;return r&&(o=~o>>>0,n=~n>>>0,++n>4294967295&&(n=0,++o>4294967295&&(o=0))),new e(n,o)}static from(t){return typeof t=="number"?e.fromNumber(t):typeof t=="bigint"?e.fromBigInt(t):typeof t=="string"?e.fromBigInt(BigInt(t)):t.low!=null||t.high!=null?new e(t.low>>>0,t.high>>>0):jt}},jt=new ft(0,0);jt.toBigInt=function(){return 0n};jt.zzEncode=jt.zzDecode=function(){return this};jt.length=function(){return 1};var xs=4294967296n;function gs(e){let t=0,r=0;for(let n=0;n<e.length;++n)r=e.charCodeAt(n),r<128?t+=1:r<2048?t+=2:(r&64512)===55296&&(e.charCodeAt(n+1)&64512)===56320?(++n,t+=4):t+=3;return t}function ws(e,t,r){if(r-t<1)return"";let o,s=[],i=0,a;for(;t<r;)a=e[t++],a<128?s[i++]=a:a>191&&a<224?s[i++]=(a&31)<<6|e[t++]&63:a>239&&a<365?(a=((a&7)<<18|(e[t++]&63)<<12|(e[t++]&63)<<6|e[t++]&63)-65536,s[i++]=55296+(a>>10),s[i++]=56320+(a&1023)):s[i++]=(a&15)<<12|(e[t++]&63)<<6|e[t++]&63,i>8191&&((o??(o=[])).push(String.fromCharCode.apply(String,s)),i=0);return o!=null?(i>0&&o.push(String.fromCharCode.apply(String,s.slice(0,i))),o.join("")):String.fromCharCode.apply(String,s.slice(0,i))}function gn(e,t,r){let n=r,o,s;for(let i=0;i<e.length;++i)o=e.charCodeAt(i),o<128?t[r++]=o:o<2048?(t[r++]=o>>6|192,t[r++]=o&63|128):(o&64512)===55296&&((s=e.charCodeAt(i+1))&64512)===56320?(o=65536+((o&1023)<<10)+(s&1023),++i,t[r++]=o>>18|240,t[r++]=o>>12&63|128,t[r++]=o>>6&63|128,t[r++]=o&63|128):(t[r++]=o>>12|224,t[r++]=o>>6&63|128,t[r++]=o&63|128);return r-n}function pt(e,t){return RangeError(`index out of range: ${e.pos} + ${t??1} > ${e.len}`)}function cr(e,t){return(e[t-4]|e[t-3]<<8|e[t-2]<<16|e[t-1]<<24)>>>0}var wn=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(t){this.buf=t,this.pos=0,this.len=t.length}uint32(){let t=4294967295;if(t=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(t=(t|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(t=(t|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return t;if((this.pos+=5)>this.len)throw this.pos=this.len,pt(this,10);return t}int32(){return this.uint32()|0}sint32(){let t=this.uint32();return t>>>1^-(t&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw pt(this,4);return cr(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw pt(this,4);return cr(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw pt(this,4);let t=ms(this.buf,this.pos);return this.pos+=4,t}double(){if(this.pos+8>this.len)throw pt(this,4);let t=ys(this.buf,this.pos);return this.pos+=8,t}bytes(){let t=this.uint32(),r=this.pos,n=this.pos+t;if(n>this.len)throw pt(this,t);return this.pos+=t,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let t=this.bytes();return ws(t,0,t.length)}skip(t){if(typeof t=="number"){if(this.pos+t>this.len)throw pt(this,t);this.pos+=t}else do if(this.pos>=this.len)throw pt(this);while((this.buf[this.pos++]&128)!==0);return this}skipType(t){switch(t){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(t=this.uint32()&7)!==4;)this.skipType(t);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${t} at offset ${this.pos}`)}return this}readLongVarint(){let t=new ft(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t;if(t.lo=(t.lo|(this.buf[this.pos]&127)<<28)>>>0,t.hi=(t.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return t;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw pt(this);if(t.lo=(t.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return t}return t.lo=(t.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,t}if(this.len-this.pos>4){for(;r<5;++r)if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}else for(;r<5;++r){if(this.pos>=this.len)throw pt(this);if(t.hi=(t.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return t}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw pt(this,8);let t=cr(this.buf,this.pos+=4),r=cr(this.buf,this.pos+=4);return new ft(t,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let t=ds(this.buf,this.pos);return this.pos+=Te(t),t}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function En(e){return new wn(e instanceof Uint8Array?e:e.subarray())}function ar(e,t,r){let n=En(e);return t.decode(n,void 0,r)}function Sn(e){let t=e??8192,r=t>>>1,n,o=t;return function(i){if(i<1||i>r)return it(i);o+i>t&&(n=it(t),o=0);let a=n.subarray(o,o+=i);return(o&7)!==0&&(o=(o|7)+1),a}}var Gt=class{fn;len;next;val;constructor(t,r,n){this.fn=t,this.len=r,this.next=void 0,this.val=n}};function An(){}var vn=class{head;tail;len;next;constructor(t){this.head=t.head,this.tail=t.tail,this.len=t.len,this.next=t.states}},Gc=Sn();function zc(e){return globalThis.Buffer!=null?it(e):Gc(e)}var Re=class{len;head;tail;states;constructor(){this.len=0,this.head=new Gt(An,0,0),this.tail=this.head,this.states=null}_push(t,r,n){return this.tail=this.tail.next=new Gt(t,r,n),this.len+=r,this}uint32(t){return this.len+=(this.tail=this.tail.next=new In((t=t>>>0)<128?1:t<16384?2:t<2097152?3:t<268435456?4:5,t)).len,this}int32(t){return t<0?this._push(fr,10,ft.fromNumber(t)):this.uint32(t)}sint32(t){return this.uint32((t<<1^t>>31)>>>0)}uint64(t){let r=ft.fromBigInt(t);return this._push(fr,r.length(),r)}uint64Number(t){return this._push(ls,Te(t),t)}uint64String(t){return this.uint64(BigInt(t))}int64(t){return this.uint64(t)}int64Number(t){return this.uint64Number(t)}int64String(t){return this.uint64String(t)}sint64(t){let r=ft.fromBigInt(t).zzEncode();return this._push(fr,r.length(),r)}sint64Number(t){let r=ft.fromNumber(t).zzEncode();return this._push(fr,r.length(),r)}sint64String(t){return this.sint64(BigInt(t))}bool(t){return this._push(Bn,1,t?1:0)}fixed32(t){return this._push(Ue,4,t>>>0)}sfixed32(t){return this.fixed32(t)}fixed64(t){let r=ft.fromBigInt(t);return this._push(Ue,4,r.lo)._push(Ue,4,r.hi)}fixed64Number(t){let r=ft.fromNumber(t);return this._push(Ue,4,r.lo)._push(Ue,4,r.hi)}fixed64String(t){return this.fixed64(BigInt(t))}sfixed64(t){return this.fixed64(t)}sfixed64Number(t){return this.fixed64Number(t)}sfixed64String(t){return this.fixed64String(t)}float(t){return this._push(ps,4,t)}double(t){return this._push(bs,8,t)}bytes(t){let r=t.length>>>0;return r===0?this._push(Bn,1,0):this.uint32(r)._push(Xc,r,t)}string(t){let r=gs(t);return r!==0?this.uint32(r)._push(gn,r,t):this._push(Bn,1,0)}fork(){return this.states=new vn(this),this.head=this.tail=new Gt(An,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Gt(An,0,0),this.len=0),this}ldelim(){let t=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=t.next,this.tail=r,this.len+=n),this}finish(){let t=this.head.next,r=zc(this.len),n=0;for(;t!=null;)t.fn(t.val,r,n),n+=t.len,t=t.next;return r}};function Bn(e,t,r){t[r]=e&255}function Yc(e,t,r){for(;e>127;)t[r++]=e&127|128,e>>>=7;t[r]=e}var In=class extends Gt{next;constructor(t,r){super(Yc,t,r),this.next=void 0}};function fr(e,t,r){for(;e.hi!==0;)t[r++]=e.lo&127|128,e.lo=(e.lo>>>7|e.hi<<25)>>>0,e.hi>>>=7;for(;e.lo>127;)t[r++]=e.lo&127|128,e.lo=e.lo>>>7;t[r++]=e.lo}function Ue(e,t,r){t[r]=e&255,t[r+1]=e>>>8&255,t[r+2]=e>>>16&255,t[r+3]=e>>>24}function Xc(e,t,r){t.set(e,r)}globalThis.Buffer!=null&&(Re.prototype.bytes=function(e){let t=e.length>>>0;return this.uint32(t),t>0&&this._push($c,t,e),this},Re.prototype.string=function(e){let t=globalThis.Buffer.byteLength(e);return this.uint32(t),t>0&&this._push(Wc,t,e),this});function $c(e,t,r){t.set(e,r)}function Wc(e,t,r){e.length<40?gn(e,t,r):t.utf8Write!=null?t.utf8Write(e,r):t.set(Dt(e),r)}function Ln(){return new Re}function ur(e,t){let r=Ln();return t.encode(e,r,{lengthDelimited:!1}),r.finish()}var ue;(function(e){e[e.VARINT=0]="VARINT",e[e.BIT64=1]="BIT64",e[e.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",e[e.START_GROUP=3]="START_GROUP",e[e.END_GROUP=4]="END_GROUP",e[e.BIT32=5]="BIT32"})(ue||(ue={}));function hr(e,t,r,n){return{name:e,type:t,encode:r,decode:n}}function _n(e){function t(o){if(e[o.toString()]==null)throw new Error("Invalid enum value");return e[o]}let r=function(s,i){let a=t(s);i.int32(a)},n=function(s){let i=s.int32();return t(i)};return hr("enum",ue.VARINT,r,n)}function lr(e,t){return hr("message",ue.LENGTH_DELIMITED,e,t)}var ut;(function(e){e.RSA="RSA",e.Ed25519="Ed25519",e.secp256k1="secp256k1",e.ECDSA="ECDSA"})(ut||(ut={}));var Dn;(function(e){e[e.RSA=0]="RSA",e[e.Ed25519=1]="Ed25519",e[e.secp256k1=2]="secp256k1",e[e.ECDSA=3]="ECDSA"})(Dn||(Dn={}));(function(e){e.codec=()=>_n(Dn)})(ut||(ut={}));var Ce;(function(e){let t;e.codec=()=>(t==null&&(t=lr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=ut.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>ur(r,e.codec()),e.decode=(r,n)=>ar(r,e.codec(),n)})(Ce||(Ce={}));var Tn;(function(e){let t;e.codec=()=>(t==null&&(t=lr((r,n,o={})=>{o.lengthDelimited!==!1&&n.fork(),r.Type!=null&&(n.uint32(8),ut.codec().encode(r.Type,n)),r.Data!=null&&(n.uint32(18),n.bytes(r.Data)),o.lengthDelimited!==!1&&n.ldelim()},(r,n,o={})=>{let s={},i=n==null?r.len:r.pos+n;for(;r.pos<i;){let a=r.uint32();switch(a>>>3){case 1:{s.Type=ut.codec().decode(r);break}case 2:{s.Data=r.bytes();break}default:{r.skipType(a&7);break}}}return s})),t),e.encode=r=>ur(r,e.codec()),e.decode=(r,n)=>ar(r,e.codec(),n)})(Tn||(Tn={}));var dr=class{oHash;iHash;blockLen;outputLen;finished=!1;destroyed=!1;constructor(t,r){if(Ye(t),O(r,void 0,"key"),this.iHash=t.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let n=this.blockLen,o=new Uint8Array(n);o.set(r.length>n?t.create().update(r).digest():r);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=t.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),St(o)}update(t){return ne(this),this.iHash.update(t),this}digestInto(t){ne(this),O(t,this.outputLen,"output"),this.finished=!0,this.iHash.digestInto(t),this.oHash.update(t),this.oHash.digestInto(t),this.destroy()}digest(){let t=new Uint8Array(this.oHash.outputLen);return this.digestInto(t),t}_cloneInto(t){t||=Object.create(Object.getPrototypeOf(this),{});let{oHash:r,iHash:n,finished:o,destroyed:s,blockLen:i,outputLen:a}=this;return t=t,t.finished=o,t.destroyed=s,t.blockLen=i,t.outputLen=a,t.oHash=r._cloneInto(t.oHash),t.iHash=n._cloneInto(t.iHash),t}clone(){return this._cloneInto()}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Un=(e,t,r)=>new dr(e,t).update(r).digest();Un.create=(e,t)=>new dr(e,t);var Ss=(e,t)=>(e+(e>=0?t:-t)/As)/t;function Qc(e,t,r){let[[n,o],[s,i]]=t,a=Ss(i*e,r),c=Ss(-o*e,r),f=e-a*n-c*s,m=-a*o-c*i,u=f<Lt,w=m<Lt;u&&(f=-f),w&&(m=-m);let S=Ie(Math.ceil(nn(r)/2))+he;if(f<Lt||f>=S||m<Lt||m>=S)throw new Error("splitScalar (endomorphism): failed, k="+e);return{k1neg:u,k1:f,k2neg:w,k2:m}}function Cn(e){if(!["compact","recovered","der"].includes(e))throw new Error('Signature format must be "compact", "recovered", or "der"');return e}function Rn(e,t){let r={};for(let n of Object.keys(t))r[n]=e[n]===void 0?t[n]:e[n];return It(r.lowS,"lowS"),It(r.prehash,"prehash"),r.format!==void 0&&Cn(r.format),r}var Kn=class extends Error{constructor(t=""){super(t)}},kt={Err:Kn,_tlv:{encode:(e,t)=>{let{Err:r}=kt;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length&1)throw new r("tlv.encode: unpadded data");let n=t.length/2,o=Be(n);if(o.length/2&128)throw new r("tlv.encode: long form length too big");let s=n>127?Be(o.length/2|128):"";return Be(e)+s+o+t},decode(e,t){let{Err:r}=kt,n=0;if(e<0||e>256)throw new r("tlv.encode: wrong tag");if(t.length<2||t[n++]!==e)throw new r("tlv.decode: wrong tlv");let o=t[n++],s=!!(o&128),i=0;if(!s)i=o;else{let c=o&127;if(!c)throw new r("tlv.decode(long): indefinite length not supported");if(c>4)throw new r("tlv.decode(long): byte length is too big");let f=t.subarray(n,n+c);if(f.length!==c)throw new r("tlv.decode: length bytes not complete");if(f[0]===0)throw new r("tlv.decode(long): zero leftmost byte");for(let m of f)i=i<<8|m;if(n+=c,i<128)throw new r("tlv.decode(long): not minimal encoding")}let a=t.subarray(n,n+i);if(a.length!==i)throw new r("tlv.decode: wrong value length");return{v:a,l:t.subarray(n+i)}}},_int:{encode(e){let{Err:t}=kt;if(e<Lt)throw new t("integer: negative integers are not allowed");let r=Be(e);if(Number.parseInt(r[0],16)&8&&(r="00"+r),r.length&1)throw new t("unexpected DER parsing assertion: unpadded hex");return r},decode(e){let{Err:t}=kt;if(e[0]&128)throw new t("invalid signature integer: negative");if(e[0]===0&&!(e[1]&128))throw new t("invalid signature integer: unnecessary leading zero");return se(e)}},toSig(e){let{Err:t,_int:r,_tlv:n}=kt,o=O(e,void 0,"signature"),{v:s,l:i}=n.decode(48,o);if(i.length)throw new t("invalid signature: left bytes after parsing");let{v:a,l:c}=n.decode(2,s),{v:f,l:m}=n.decode(2,c);if(m.length)throw new t("invalid signature: left bytes after parsing");return{r:r.decode(a),s:r.decode(f)}},hexFromSig(e){let{_tlv:t,_int:r}=kt,n=t.encode(2,r.encode(e.r)),o=t.encode(2,r.encode(e.s)),s=n+o;return t.encode(48,s)}},Lt=BigInt(0),he=BigInt(1),As=BigInt(2),pr=BigInt(3),ta=BigInt(4);function Bs(e,t={}){let r=tr("weierstrass",e,t),{Fp:n,Fn:o}=r,s=r.CURVE,{h:i,n:a}=s;Ct(t,{},{allowInfinityPoint:"boolean",clearCofactor:"function",isTorsionFree:"function",fromBytes:"function",toBytes:"function",endo:"object"});let{endo:c}=t;if(c&&(!n.is0(s.a)||typeof c.beta!="bigint"||!Array.isArray(c.basises)))throw new Error('invalid endo: expected "beta": bigint and "basises": array');let f=Is(n,o);function m(){if(!n.isOdd)throw new Error("compression is not supported: Field does not have .isOdd()")}function u(T,l,d){let{x:h,y:E}=l.toAffine(),L=n.toBytes(h);if(It(d,"isCompressed"),d){m();let D=!n.isOdd(E);return ot(vs(D),L)}else return ot(Uint8Array.of(4),L,n.toBytes(E))}function w(T){O(T,void 0,"Point");let{publicKey:l,publicKeyUncompressed:d}=f,h=T.length,E=T[0],L=T.subarray(1);if(h===l&&(E===2||E===3)){let D=n.fromBytes(L);if(!n.isValid(D))throw new Error("bad point: is not on curve, wrong x");let U=v(D),_;try{_=n.sqrt(U)}catch(Z){let q=Z instanceof Error?": "+Z.message:"";throw new Error("bad point: is not on curve, sqrt error"+q)}m();let R=n.isOdd(_);return(E&1)===1!==R&&(_=n.neg(_)),{x:D,y:_}}else if(h===d&&E===4){let D=n.BYTES,U=n.fromBytes(L.subarray(0,D)),_=n.fromBytes(L.subarray(D,D*2));if(!A(U,_))throw new Error("bad point: is not on curve");return{x:U,y:_}}else throw new Error(`bad point: got length ${h}, expected compressed=${l} or uncompressed=${d}`)}let S=t.toBytes||u,p=t.fromBytes||w;function v(T){let l=n.sqr(T),d=n.mul(l,T);return n.add(n.add(d,n.mul(T,s.a)),s.b)}function A(T,l){let d=n.sqr(l),h=v(T);return n.eql(d,h)}if(!A(s.Gx,s.Gy))throw new Error("bad curve params: generator point");let b=n.mul(n.pow(s.a,pr),ta),B=n.mul(n.sqr(s.b),BigInt(27));if(n.is0(n.add(b,B)))throw new Error("bad curve params: a or b");function y(T,l,d=!1){if(!n.isValid(l)||d&&n.is0(l))throw new Error(`bad point coordinate ${T}`);return l}function I(T){if(!(T instanceof x))throw new Error("Weierstrass Point expected")}function C(T){if(!c||!c.basises)throw new Error("no endo");return Qc(T,c.basises,o.ORDER)}let k=ie((T,l)=>{let{X:d,Y:h,Z:E}=T;if(n.eql(E,n.ONE))return{x:d,y:h};let L=T.is0();l==null&&(l=L?n.ONE:n.inv(E));let D=n.mul(d,l),U=n.mul(h,l),_=n.mul(E,l);if(L)return{x:n.ZERO,y:n.ZERO};if(!n.eql(_,n.ONE))throw new Error("invZ was invalid");return{x:D,y:U}}),P=ie(T=>{if(T.is0()){if(t.allowInfinityPoint&&!n.is0(T.Y))return;throw new Error("bad point: ZERO")}let{x:l,y:d}=T.toAffine();if(!n.isValid(l)||!n.isValid(d))throw new Error("bad point: x or y not field elements");if(!A(l,d))throw new Error("bad point: equation left != right");if(!T.isTorsionFree())throw new Error("bad point: not in prime-order subgroup");return!0});function g(T,l,d,h,E){return d=new x(n.mul(d.X,T),d.Y,d.Z),l=_e(h,l),d=_e(E,d),l.add(d)}class x{static BASE=new x(s.Gx,s.Gy,n.ONE);static ZERO=new x(n.ZERO,n.ONE,n.ZERO);static Fp=n;static Fn=o;X;Y;Z;constructor(l,d,h){this.X=y("x",l),this.Y=y("y",d,!0),this.Z=y("z",h),Object.freeze(this)}static CURVE(){return s}static fromAffine(l){let{x:d,y:h}=l||{};if(!l||!n.isValid(d)||!n.isValid(h))throw new Error("invalid affine point");if(l instanceof x)throw new Error("projective point not allowed");return n.is0(d)&&n.is0(h)?x.ZERO:new x(d,h,n.ONE)}static fromBytes(l){let d=x.fromAffine(p(O(l,void 0,"point")));return d.assertValidity(),d}static fromHex(l){return x.fromBytes(Bt(l))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}precompute(l=8,d=!0){return M.createCache(this,l),d||this.multiply(pr),this}assertValidity(){P(this)}hasEvenY(){let{y:l}=this.toAffine();if(!n.isOdd)throw new Error("Field doesn't support isOdd");return!n.isOdd(l)}equals(l){I(l);let{X:d,Y:h,Z:E}=this,{X:L,Y:D,Z:U}=l,_=n.eql(n.mul(d,U),n.mul(L,E)),R=n.eql(n.mul(h,U),n.mul(D,E));return _&&R}negate(){return new x(this.X,n.neg(this.Y),this.Z)}double(){let{a:l,b:d}=s,h=n.mul(d,pr),{X:E,Y:L,Z:D}=this,U=n.ZERO,_=n.ZERO,R=n.ZERO,N=n.mul(E,E),Z=n.mul(L,L),q=n.mul(D,D),H=n.mul(E,L);return H=n.add(H,H),R=n.mul(E,D),R=n.add(R,R),U=n.mul(l,R),_=n.mul(h,q),_=n.add(U,_),U=n.sub(Z,_),_=n.add(Z,_),_=n.mul(U,_),U=n.mul(H,U),R=n.mul(h,R),q=n.mul(l,q),H=n.sub(N,q),H=n.mul(l,H),H=n.add(H,R),R=n.add(N,N),N=n.add(R,N),N=n.add(N,q),N=n.mul(N,H),_=n.add(_,N),q=n.mul(L,D),q=n.add(q,q),N=n.mul(q,H),U=n.sub(U,N),R=n.mul(q,Z),R=n.add(R,R),R=n.add(R,R),new x(U,_,R)}add(l){I(l);let{X:d,Y:h,Z:E}=this,{X:L,Y:D,Z:U}=l,_=n.ZERO,R=n.ZERO,N=n.ZERO,Z=s.a,q=n.mul(s.b,pr),H=n.mul(d,L),F=n.mul(h,D),W=n.mul(E,U),mt=n.add(d,h),j=n.add(L,D);mt=n.mul(mt,j),j=n.add(H,F),mt=n.sub(mt,j),j=n.add(d,E);let Q=n.add(L,U);return j=n.mul(j,Q),Q=n.add(H,W),j=n.sub(j,Q),Q=n.add(h,E),_=n.add(D,U),Q=n.mul(Q,_),_=n.add(F,W),Q=n.sub(Q,_),N=n.mul(Z,j),_=n.mul(q,W),N=n.add(_,N),_=n.sub(F,N),N=n.add(F,N),R=n.mul(_,N),F=n.add(H,H),F=n.add(F,H),W=n.mul(Z,W),j=n.mul(q,j),F=n.add(F,W),W=n.sub(H,W),W=n.mul(Z,W),j=n.add(j,W),H=n.mul(F,j),R=n.add(R,H),H=n.mul(Q,j),_=n.mul(mt,_),_=n.sub(_,H),H=n.mul(mt,F),N=n.mul(Q,N),N=n.add(N,H),new x(_,R,N)}subtract(l){return this.add(l.negate())}is0(){return this.equals(x.ZERO)}multiply(l){let{endo:d}=t;if(!o.isValidNot0(l))throw new Error("invalid scalar: out of range");let h,E,L=D=>M.cached(this,D,U=>Ft(x,U));if(d){let{k1neg:D,k1:U,k2neg:_,k2:R}=C(l),{p:N,f:Z}=L(U),{p:q,f:H}=L(R);E=Z.add(H),h=g(d.beta,N,q,D,_)}else{let{p:D,f:U}=L(l);h=D,E=U}return Ft(x,[h,E])[0]}multiplyUnsafe(l){let{endo:d}=t,h=this;if(!o.isValid(l))throw new Error("invalid scalar: out of range");if(l===Lt||h.is0())return x.ZERO;if(l===he)return h;if(M.hasCache(this))return this.multiply(l);if(d){let{k1neg:E,k1:L,k2neg:D,k2:U}=C(l),{p1:_,p2:R}=Jo(x,h,L,U);return g(d.beta,_,R,E,D)}else return M.unsafe(h,l)}toAffine(l){return k(this,l)}isTorsionFree(){let{isTorsionFree:l}=t;return i===he?!0:l?l(x,this):M.unsafe(this,a).is0()}clearCofactor(){let{clearCofactor:l}=t;return i===he?this:l?l(x,this):this.multiplyUnsafe(i)}isSmallOrder(){return this.multiplyUnsafe(i).is0()}toBytes(l=!0){return It(l,"isCompressed"),this.assertValidity(),S(x,this,l)}toHex(l=!0){return At(this.toBytes(l))}toString(){return`<Point ${this.is0()?"ZERO":this.toHex()}>`}}let K=o.BITS,M=new fe(x,t.endo?Math.ceil(K/2):K);return x.BASE.precompute(8),x}function vs(e){return Uint8Array.of(e?2:3)}function Is(e,t){return{secretKey:t.BYTES,publicKey:1+e.BYTES,publicKeyUncompressed:1+2*e.BYTES,publicKeyHasPrefix:!0,signature:2*t.BYTES}}function ea(e,t={}){let{Fn:r}=e,n=t.randomBytes||oe,o=Object.assign(Is(e.Fp,r),{seed:an(r.ORDER)});function s(S){try{let p=r.fromBytes(S);return r.isValidNot0(p)}catch{return!1}}function i(S,p){let{publicKey:v,publicKeyUncompressed:A}=o;try{let b=S.length;return p===!0&&b!==v||p===!1&&b!==A?!1:!!e.fromBytes(S)}catch{return!1}}function a(S=n(o.seed)){return fn(O(S,o.seed,"seed"),r.ORDER)}function c(S,p=!0){return e.BASE.multiply(r.fromBytes(S)).toBytes(p)}function f(S){let{secretKey:p,publicKey:v,publicKeyUncompressed:A}=o;if(!Pt(S)||"_lengths"in r&&r._lengths||p===v)return;let b=O(S,void 0,"key").length;return b===v||b===A}function m(S,p,v=!0){if(f(S)===!0)throw new Error("first arg must be private key");if(f(p)===!1)throw new Error("second arg must be public key");let A=r.fromBytes(S);return e.fromBytes(p).multiply(A).toBytes(v)}let u={isValidSecretKey:s,isValidPublicKey:i,randomSecretKey:a},w=er(a,c);return Object.freeze({getPublicKey:c,getSharedSecret:m,keygen:w,Point:e,utils:u,lengths:o})}function Ls(e,t,r={}){Ye(t),Ct(r,{},{hmac:"function",lowS:"boolean",randomBytes:"function",bits2int:"function",bits2int_modN:"function"}),r=Object.assign({},r);let n=r.randomBytes||oe,o=r.hmac||((d,h)=>Un(t,d,h)),{Fp:s,Fn:i}=e,{ORDER:a,BITS:c}=i,{keygen:f,getPublicKey:m,getSharedSecret:u,utils:w,lengths:S}=ea(e,r),p={prehash:!0,lowS:typeof r.lowS=="boolean"?r.lowS:!0,format:"compact",extraEntropy:!1},v=a*As<s.ORDER;function A(d){let h=a>>he;return d>h}function b(d,h){if(!i.isValidNot0(h))throw new Error(`invalid signature ${d}: out of range 1..Point.Fn.ORDER`);return h}function B(){if(v)throw new Error('"recovered" sig type is not supported for cofactor >2 curves')}function y(d,h){Cn(h);let E=S.signature,L=h==="compact"?E:h==="recovered"?E+1:void 0;return O(d,L)}class I{r;s;recovery;constructor(h,E,L){if(this.r=b("r",h),this.s=b("s",E),L!=null){if(B(),![0,1,2,3].includes(L))throw new Error("invalid recovery id");this.recovery=L}Object.freeze(this)}static fromBytes(h,E=p.format){y(h,E);let L;if(E==="der"){let{r:R,s:N}=kt.toSig(O(h));return new I(R,N)}E==="recovered"&&(L=h[0],E="compact",h=h.subarray(1));let D=S.signature/2,U=h.subarray(0,D),_=h.subarray(D,D*2);return new I(i.fromBytes(U),i.fromBytes(_),L)}static fromHex(h,E){return this.fromBytes(Bt(h),E)}assertRecovery(){let{recovery:h}=this;if(h==null)throw new Error("invalid recovery id: must be present");return h}addRecoveryBit(h){return new I(this.r,this.s,h)}recoverPublicKey(h){let{r:E,s:L}=this,D=this.assertRecovery(),U=D===2||D===3?E+a:E;if(!s.isValid(U))throw new Error("invalid recovery id: sig.r+curve.n != R.x");let _=s.toBytes(U),R=e.fromBytes(ot(vs((D&1)===0),_)),N=i.inv(U),Z=k(O(h,void 0,"msgHash")),q=i.create(-Z*N),H=i.create(L*N),F=e.BASE.multiplyUnsafe(q).add(R.multiplyUnsafe(H));if(F.is0())throw new Error("invalid recovery: point at infinify");return F.assertValidity(),F}hasHighS(){return A(this.s)}toBytes(h=p.format){if(Cn(h),h==="der")return Bt(kt.hexFromSig(this));let{r:E,s:L}=this,D=i.toBytes(E),U=i.toBytes(L);return h==="recovered"?(B(),ot(Uint8Array.of(this.assertRecovery()),D,U)):ot(D,U)}toHex(h){return At(this.toBytes(h))}}let C=r.bits2int||function(h){if(h.length>8192)throw new Error("input is too large");let E=se(h),L=h.length*8-c;return L>0?E>>BigInt(L):E},k=r.bits2int_modN||function(h){return i.create(C(h))},P=Ie(c);function g(d){return ve("num < 2^"+c,d,Lt,P),i.toBytes(d)}function x(d,h){return O(d,void 0,"message"),h?O(t(d),void 0,"prehashed message"):d}function K(d,h,E){let{lowS:L,prehash:D,extraEntropy:U}=Rn(E,p);d=x(d,D);let _=k(d),R=i.fromBytes(h);if(!i.isValidNot0(R))throw new Error("invalid private key");let N=[g(R),g(_)];if(U!=null&&U!==!1){let F=U===!0?n(S.secretKey):U;N.push(O(F,void 0,"extraEntropy"))}let Z=ot(...N),q=_;function H(F){let W=C(F);if(!i.isValidNot0(W))return;let mt=i.inv(W),j=e.BASE.multiply(W).toAffine(),Q=i.create(j.x);if(Q===Lt)return;let Me=i.create(mt*i.create(q+Q*R));if(Me===Lt)return;let Pn=(j.x===Q?0:2)|Number(j.y&he),Mn=Me;return L&&A(Me)&&(Mn=i.neg(Me),Pn^=1),new I(Q,Mn,v?void 0:Pn)}return{seed:Z,k2sig:H}}function M(d,h,E={}){let{seed:L,k2sig:D}=K(d,h,E);return No(t.outputLen,i.BYTES,o)(L,D).toBytes(E.format)}function T(d,h,E,L={}){let{lowS:D,prehash:U,format:_}=Rn(L,p);if(E=O(E,void 0,"publicKey"),h=x(h,U),!Pt(d)){let R=d instanceof I?", use sig.toBytes()":"";throw new Error("verify expects Uint8Array signature"+R)}y(d,_);try{let R=I.fromBytes(d,_),N=e.fromBytes(E);if(D&&R.hasHighS())return!1;let{r:Z,s:q}=R,H=k(h),F=i.inv(q),W=i.create(H*F),mt=i.create(Z*F),j=e.BASE.multiplyUnsafe(W).add(N.multiplyUnsafe(mt));return j.is0()?!1:i.create(j.x)===Z}catch{return!1}}function l(d,h,E={}){let{prehash:L}=Rn(E,p);return h=x(h,L),I.fromBytes(d,"recovered").recoverPublicKey(h).toBytes()}return Object.freeze({keygen:f,getPublicKey:m,getSharedSecret:u,utils:w,lengths:S,Point:e,sign:M,verify:T,recoverPublicKey:l,Signature:I,hash:t})}var On={p:BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),n:BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),h:BigInt(1),a:BigInt(0),b:BigInt(7),Gx:BigInt("0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798"),Gy:BigInt("0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8")},ra={beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),basises:[[BigInt("0x3086d221a7d46bcde86c90e49284eb15"),-BigInt("0xe4437ed6010e88286f547fa90abfe4c3")],[BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),BigInt("0x3086d221a7d46bcde86c90e49284eb15")]]};var _s=BigInt(2);function na(e){let t=On.p,r=BigInt(3),n=BigInt(6),o=BigInt(11),s=BigInt(22),i=BigInt(23),a=BigInt(44),c=BigInt(88),f=e*e*e%t,m=f*f*e%t,u=V(m,r,t)*m%t,w=V(u,r,t)*m%t,S=V(w,_s,t)*f%t,p=V(S,o,t)*S%t,v=V(p,s,t)*p%t,A=V(v,a,t)*v%t,b=V(A,c,t)*A%t,B=V(b,a,t)*v%t,y=V(B,r,t)*m%t,I=V(y,i,t)*p%t,C=V(I,n,t)*f%t,k=V(C,_s,t);if(!Nn.eql(Nn.sqr(k),e))throw new Error("Cannot find square root");return k}var Nn=ce(On.p,{sqrt:na}),oa=Bs(On,{Fp:Nn,endo:ra}),le=Ls(oa,Uo);function Ds(e,t,r,n){let o=xe.digest(r instanceof Uint8Array?r:r.subarray());if(sr(o))return o.then(({digest:s})=>(n?.signal?.throwIfAborted(),le.verify(t,s,e,{prehash:!1,format:"der"}))).catch(s=>{throw s.name==="AbortError"?s:new De(String(s))});try{return n?.signal?.throwIfAborted(),le.verify(t,o.digest,e,{prehash:!1,format:"der"})}catch(s){throw new De(String(s))}}var mr=class{type="secp256k1";raw;_key;constructor(t){this._key=Us(t),this.raw=Ts(this._key)}toMultihash(){return ht.digest(re(this))}toCID(){return et.createV1(114,this.toMultihash())}toString(){return Y.encode(this.toMultihash().bytes).substring(1)}equals(t){return t==null||!(t.raw instanceof Uint8Array)?!1:lt(this.raw,t.raw)}verify(t,r,n){return Ds(this._key,r,t,n)}};function Rs(e){return new mr(e)}function Ts(e){return le.Point.fromBytes(e).toBytes()}function Us(e){try{return le.Point.fromBytes(e),e}catch(t){throw new He(String(t))}}function Cs(e){let{Type:t,Data:r}=Ce.decode(e.digest),n=r??new Uint8Array;switch(t){case ut.Ed25519:return cs(n);case ut.secp256k1:return Rs(n);case ut.ECDSA:return po(n);default:throw new zt}}function re(e){return Ce.encode({Type:ut[e.type],Data:e.raw})}var Ks=Symbol.for("nodejs.util.inspect.custom"),sa=114,Ke=class{type;multihash;publicKey;string;constructor(t){this.type=t.type,this.multihash=t.multihash,Object.defineProperty(this,"string",{enumerable:!1,writable:!0})}get[Symbol.toStringTag](){return`PeerId(${this.toString()})`}[yr]=!0;toString(){return this.string==null&&(this.string=Y.encode(this.multihash.bytes).slice(1)),this.string}toMultihash(){return this.multihash}toCID(){return et.createV1(sa,this.multihash)}toJSON(){return this.toString()}equals(t){if(t==null)return!1;if(t instanceof Uint8Array)return lt(this.multihash.bytes,t);if(typeof t=="string")return this.toString()===t;if(t?.toMultihash()?.bytes!=null)return lt(this.multihash.bytes,t.toMultihash().bytes);throw new Error("not valid Id")}[Ks](){return`PeerId(${this.toString()})`}},Ne=class extends Ke{type="RSA";publicKey;constructor(t){super({...t,type:"RSA"}),this.publicKey=t.publicKey}},Oe=class extends Ke{type="Ed25519";publicKey;constructor(t){super({...t,type:"Ed25519"}),this.publicKey=t.publicKey}},ke=class extends Ke{type="secp256k1";publicKey;constructor(t){super({...t,type:"secp256k1"}),this.publicKey=t.publicKey}},ia=2336,Pe=class{type="url";multihash;publicKey;url;constructor(t){this.url=t.toString(),this.multihash=ht.digest(Dt(this.url))}[Ks](){return`PeerId(${this.url})`}[yr]=!0;toString(){return this.toCID().toString()}toMultihash(){return this.multihash}toCID(){return et.createV1(ia,this.toMultihash())}toJSON(){return this.toString()}equals(t){return t==null?!1:(t instanceof Uint8Array&&(t=at(t)),t.toString()===this.toString())}};var ca=114,Ns=2336;function aa(e,t){let r;if(e.charAt(0)==="1"||e.charAt(0)==="Q")r=be(Y.decode(`z${e}`));else{if(e.startsWith("k51qzi5uqu5")||e.startsWith("kzwfwjn5ji4")||e.startsWith("k2k4r8")||e.startsWith("bafz"))return ks(et.parse(e));if(t==null)throw new bt('Please pass a multibase decoder for strings that do not start with "1" or "Q"');r=be(t.decode(e))}return kn(r)}function Os(e){if(e.type==="Ed25519")return new Oe({multihash:e.toCID().multihash,publicKey:e});if(e.type==="secp256k1")return new ke({multihash:e.toCID().multihash,publicKey:e});if(e.type==="RSA")return new Ne({multihash:e.toCID().multihash,publicKey:e});throw new zt}function fa(e){return Os(e.publicKey)}function kn(e){if(ha(e))return new Ne({multihash:e});if(ua(e))try{let t=Cs(e);if(t.type==="Ed25519")return new Oe({multihash:e,publicKey:t});if(t.type==="secp256k1")return new ke({multihash:e,publicKey:t})}catch{let r=at(e.digest);return new Pe(new URL(r))}throw new Ve("Supplied PeerID Multihash is invalid")}function ks(e){if(e?.multihash==null||e.version==null||e.version===1&&e.code!==ca&&e.code!==Ns)throw new qe("Supplied PeerID CID is invalid");if(e.code===Ns){let t=at(e.multihash.digest);return new Pe(new URL(t))}return kn(e.multihash)}function ua(e){return e.code===ht.code}function ha(e){return e.code===xe.code}return Vs(la);})();
/*! Bundled license information:

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/utils.js:
@noble/curves/abstract/modular.js:
@noble/curves/abstract/curve.js:
@noble/curves/abstract/edwards.js:
@noble/curves/ed25519.js:
@noble/curves/abstract/weierstrass.js:
@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)
*/
return Libp2PPeerId}));
//# sourceMappingURL=index.min.js.map
